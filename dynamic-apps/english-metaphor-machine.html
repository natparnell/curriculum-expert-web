<!DOCTYPE html>
<html lang="en-GB">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Metaphor &amp; Simile Machine</title>
<style>
  :root {
    --bg-primary: #1a1210;
    --bg-secondary: #251c18;
    --bg-panel: #2a1f1a;
    --bg-card: #352920;
    --bg-card-hover: #3f3228;
    --border-colour: #4a3a2e;
    --text-primary: #ede4da;
    --text-secondary: #b8a898;
    --text-muted: #7a6a5a;
    --accent-gold: #d4a843;
    --accent-gold-dim: #a07e30;
    --accent-warm: #c0784a;
    --accent-teal: #5a9e8f;
    --accent-rose: #c0586a;
    --accent-violet: #8a6aaa;
    --tenor-colour: #c0784a;
    --vehicle-colour: #5a9e8f;
    --paired-colour: #d4a843;
    --radius: 8px;
    --radius-lg: 12px;
    --shadow: 0 2px 12px rgba(0,0,0,0.5);
    --shadow-lg: 0 4px 24px rgba(0,0,0,0.6);
    --font-main: 'Segoe UI', system-ui, -apple-system, sans-serif;
    --font-serif: Georgia, 'Times New Roman', serif;
    --transition: 0.3s ease;
  }

  *, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: var(--font-main);
    background: var(--bg-primary);
    color: var(--text-primary);
    min-height: 100vh;
    line-height: 1.6;
  }

  /* ── Sticky Header ── */
  .header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: linear-gradient(135deg, var(--bg-secondary) 0%, #1a1410 100%);
    border-bottom: 1px solid var(--border-colour);
    padding: 14px 24px;
    box-shadow: var(--shadow);
  }

  .header h1 {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--accent-gold);
    letter-spacing: 0.5px;
    font-family: var(--font-serif);
  }

  .header p {
    font-size: 0.85rem;
    color: var(--text-secondary);
    margin-top: 2px;
  }

  /* ── Tabs ── */
  .tab-bar {
    display: flex;
    gap: 4px;
    background: var(--bg-secondary);
    padding: 8px 24px 0;
    border-bottom: 1px solid var(--border-colour);
  }

  .tab-btn {
    padding: 8px 18px;
    background: transparent;
    border: 1px solid transparent;
    border-bottom: none;
    border-radius: var(--radius) var(--radius) 0 0;
    colour: var(--text-secondary);
    color: var(--text-secondary);
    font-size: 0.85rem;
    cursor: pointer;
    transition: var(--transition);
    font-family: var(--font-main);
  }

  .tab-btn:hover { background: var(--bg-panel); color: var(--text-primary); }
  .tab-btn.active {
    background: var(--bg-panel);
    color: var(--accent-gold);
    border-color: var(--border-colour);
    font-weight: 600;
  }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  /* ── Main Layout ── */
  .main-layout {
    display: grid;
    grid-template-columns: 340px 1fr;
    gap: 0;
    min-height: calc(100vh - 120px);
  }

  /* ── Cards Panel ── */
  .cards-panel {
    background: var(--bg-secondary);
    border-right: 1px solid var(--border-colour);
    padding: 20px;
    overflow-y: auto;
  }

  .card-section-title {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin-bottom: 10px;
    padding-bottom: 6px;
    border-bottom: 1px solid var(--border-colour);
  }

  .card-section-title.tenor { color: var(--tenor-colour); }
  .card-section-title.vehicle { color: var(--vehicle-colour); }

  .card-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    margin-bottom: 24px;
  }

  .card {
    padding: 12px 10px;
    border-radius: var(--radius);
    border: 2px solid var(--border-colour);
    background: var(--bg-card);
    cursor: grab;
    text-align: centre;
    text-align: center;
    transition: var(--transition);
    user-select: none;
    -webkit-user-select: none;
  }

  .card:active { cursor: grabbing; }
  .card:hover { background: var(--bg-card-hover); transform: translateY(-2px); box-shadow: var(--shadow); }

  .card .card-emoji { font-size: 1.5rem; display: block; margin-bottom: 4px; }
  .card .card-label { font-size: 0.8rem; font-weight: 600; }

  .card.tenor { border-color: var(--tenor-colour); }
  .card.tenor .card-label { color: var(--tenor-colour); }
  .card.vehicle { border-color: var(--vehicle-colour); }
  .card.vehicle .card-label { color: var(--vehicle-colour); }

  .card.dragging { opacity: 0.4; transform: scale(0.95); }
  .card.selected { box-shadow: 0 0 0 3px var(--accent-gold); transform: translateY(-2px); }

  /* ── Drop Zone ── */
  .drop-zone-wrapper {
    padding: 20px 24px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .pairing-area {
    display: flex;
    gap: 20px;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
  }

  .drop-zone {
    width: 140px;
    height: 100px;
    border: 2px dashed var(--border-colour);
    border-radius: var(--radius-lg);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
    background: var(--bg-card);
  }

  .drop-zone.tenor-zone { border-color: var(--tenor-colour); }
  .drop-zone.vehicle-zone { border-color: var(--vehicle-colour); }

  .drop-zone.drag-over {
    background: rgba(212, 168, 67, 0.1);
    border-color: var(--accent-gold);
    box-shadow: 0 0 16px rgba(212, 168, 67, 0.2);
  }

  .drop-zone .zone-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-muted);
  }

  .drop-zone .zone-emoji { font-size: 1.6rem; }
  .drop-zone .zone-name { font-size: 0.9rem; font-weight: 600; color: var(--text-primary); }

  .drop-zone.filled { border-style: solid; }
  .drop-zone.tenor-zone.filled { background: rgba(192, 120, 74, 0.12); }
  .drop-zone.vehicle-zone.filled { background: rgba(90, 158, 143, 0.12); }

  .pairing-connector {
    font-size: 1.6rem;
    color: var(--text-muted);
    font-weight: 300;
  }

  .btn-row {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn {
    padding: 8px 20px;
    border-radius: var(--radius);
    border: 1px solid var(--border-colour);
    background: var(--bg-card);
    color: var(--text-primary);
    font-size: 0.85rem;
    cursor: pointer;
    transition: var(--transition);
    font-family: var(--font-main);
  }

  .btn:hover { background: var(--bg-card-hover); }
  .btn.primary { background: var(--accent-gold-dim); border-color: var(--accent-gold); color: #fff; }
  .btn.primary:hover { background: var(--accent-gold); }
  .btn:disabled { opacity: 0.4; cursor: not-allowed; }

  /* ── Canvas Area ── */
  .canvas-wrapper {
    background: var(--bg-panel);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-colour);
    padding: 16px;
    text-align: center;
  }

  .canvas-wrapper canvas {
    border-radius: var(--radius);
    max-width: 100%;
    display: block;
    margin: 0 auto;
  }

  .morph-slider-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 12px;
    justify-content: center;
  }

  .morph-slider-row label {
    font-size: 0.75rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 1px;
    min-width: 60px;
    text-align: right;
  }

  .morph-slider-row label:last-child { text-align: left; }

  input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    height: 6px;
    background: var(--border-colour);
    border-radius: 3px;
    outline: none;
    flex: 1;
    max-width: 300px;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: var(--accent-gold);
    cursor: pointer;
    border: 2px solid var(--bg-primary);
  }

  /* ── Result Panel ── */
  .result-panel {
    background: var(--bg-panel);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-colour);
    padding: 24px;
  }

  .result-panel h3 {
    font-family: var(--font-serif);
    color: var(--accent-gold);
    font-size: 1.1rem;
    margin-bottom: 12px;
  }

  .metaphor-sentence {
    font-family: var(--font-serif);
    font-size: 1.2rem;
    color: var(--text-primary);
    font-style: italic;
    padding: 16px;
    background: rgba(212, 168, 67, 0.06);
    border-left: 3px solid var(--accent-gold);
    border-radius: 0 var(--radius) var(--radius) 0;
    margin-bottom: 16px;
    line-height: 1.7;
  }

  .explanation-section { margin-bottom: 14px; }

  .explanation-section h4 {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--accent-warm);
    margin-bottom: 6px;
  }

  .explanation-section p {
    font-size: 0.9rem;
    color: var(--text-secondary);
    line-height: 1.7;
  }

  .lit-example {
    font-family: var(--font-serif);
    font-style: italic;
    color: var(--text-primary);
    padding: 10px 14px;
    background: rgba(90, 158, 143, 0.08);
    border-left: 3px solid var(--accent-teal);
    border-radius: 0 var(--radius) var(--radius) 0;
    margin: 8px 0;
    font-size: 0.9rem;
  }

  .lit-source {
    font-style: normal;
    color: var(--text-muted);
    font-size: 0.8rem;
    font-family: var(--font-main);
  }

  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--text-muted);
  }

  .empty-state .empty-icon { font-size: 2.5rem; margin-bottom: 12px; }
  .empty-state p { font-size: 0.9rem; }

  /* ── Info Panel (Theory Tab) ── */
  .info-panel {
    max-width: 780px;
    margin: 0 auto;
    padding: 30px 24px;
  }

  .info-block {
    background: var(--bg-panel);
    border: 1px solid var(--border-colour);
    border-radius: var(--radius-lg);
    padding: 24px;
    margin-bottom: 20px;
  }

  .info-block h2 {
    font-family: var(--font-serif);
    color: var(--accent-gold);
    font-size: 1.15rem;
    margin-bottom: 12px;
  }

  .info-block h3 {
    color: var(--accent-warm);
    font-size: 0.95rem;
    margin: 14px 0 6px;
  }

  .info-block p, .info-block li {
    font-size: 0.9rem;
    color: var(--text-secondary);
    line-height: 1.75;
  }

  .info-block ul { padding-left: 20px; margin: 8px 0; }
  .info-block li { margin-bottom: 4px; }

  .info-block .term {
    display: inline-block;
    background: rgba(212, 168, 67, 0.12);
    color: var(--accent-gold);
    padding: 1px 8px;
    border-radius: 4px;
    font-weight: 600;
    font-size: 0.85rem;
  }

  /* ── Create Your Own Tab ── */
  .create-panel {
    max-width: 780px;
    margin: 0 auto;
    padding: 30px 24px;
  }

  .create-form {
    background: var(--bg-panel);
    border: 1px solid var(--border-colour);
    border-radius: var(--radius-lg);
    padding: 24px;
    margin-bottom: 20px;
  }

  .create-form h2 {
    font-family: var(--font-serif);
    color: var(--accent-gold);
    font-size: 1.15rem;
    margin-bottom: 16px;
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
    margin-bottom: 14px;
  }

  .form-group { display: flex; flex-direction: column; gap: 4px; }

  .form-group label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-muted);
  }

  .form-group input, .form-group textarea {
    padding: 8px 12px;
    border-radius: var(--radius);
    border: 1px solid var(--border-colour);
    background: var(--bg-card);
    color: var(--text-primary);
    font-family: var(--font-main);
    font-size: 0.9rem;
  }

  .form-group textarea { resize: vertical; min-height: 60px; }
  .form-group input:focus, .form-group textarea:focus { outline: none; border-color: var(--accent-gold); }

  .custom-output {
    background: var(--bg-panel);
    border: 1px solid var(--border-colour);
    border-radius: var(--radius-lg);
    padding: 24px;
  }

  .custom-output h3 {
    font-family: var(--font-serif);
    color: var(--accent-gold);
    margin-bottom: 12px;
  }

  /* ── Responsive ── */
  @media (max-width: 768px) {
    .main-layout {
      grid-template-columns: 1fr;
    }

    .cards-panel {
      border-right: none;
      border-bottom: 1px solid var(--border-colour);
      max-height: 260px;
    }

    .card-grid {
      grid-template-columns: repeat(3, 1fr);
    }

    .header h1 { font-size: 1.2rem; }
    .tab-btn { padding: 6px 12px; font-size: 0.8rem; }
    .pairing-area { flex-direction: column; gap: 10px; }
    .form-row { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<!-- ── Header ── -->
<header class="header">
  <h1>Metaphor &amp; Simile Machine</h1>
  <p>Drag tenor and vehicle cards together to construct figurative language and watch meanings blend</p>
</header>

<!-- ── Tabs ── -->
<div class="tab-bar">
  <button class="tab-btn active" data-tab="machine">Machine</button>
  <button class="tab-btn" data-tab="theory">Theory &amp; Terms</button>
  <button class="tab-btn" data-tab="create">Create Your Own</button>
</div>

<!-- ══════════ TAB 1: Machine ══════════ -->
<div class="tab-content active" id="tab-machine">
  <div class="main-layout">
    <!-- Cards Panel -->
    <aside class="cards-panel">
      <div class="card-section-title tenor">Tenors (the subject)</div>
      <div class="card-grid" id="tenor-grid"></div>
      <div class="card-section-title vehicle">Vehicles (the comparison)</div>
      <div class="card-grid" id="vehicle-grid"></div>
      <div style="margin-top: 8px;">
        <button class="btn" id="btn-clear" style="width:100%;">Clear Pairing</button>
      </div>
    </aside>

    <!-- Right: Drop Zones, Canvas, Result -->
    <div class="drop-zone-wrapper">
      <!-- Pairing Area -->
      <div class="pairing-area">
        <div class="drop-zone tenor-zone" id="tenor-drop">
          <span class="zone-label">Tenor</span>
        </div>
        <span class="pairing-connector">is</span>
        <div class="drop-zone vehicle-zone" id="vehicle-drop">
          <span class="zone-label">Vehicle</span>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn primary" id="btn-generate" disabled>Generate Metaphor</button>
        <button class="btn" id="btn-simile" disabled>As Simile Instead</button>
      </div>

      <!-- Canvas -->
      <div class="canvas-wrapper" id="canvas-area" style="display:none;">
        <canvas id="blend-canvas" width="560" height="280"></canvas>
        <div class="morph-slider-row">
          <label>Literal</label>
          <input type="range" id="morph-slider" min="0" max="100" value="0">
          <label>Figurative</label>
        </div>
      </div>

      <!-- Result -->
      <div id="result-area"></div>
    </div>
  </div>
</div>

<!-- ══════════ TAB 2: Theory ══════════ -->
<div class="tab-content" id="tab-theory">
  <div class="info-panel">
    <div class="info-block">
      <h2>Metaphor vs Simile</h2>
      <p>A <span class="term">metaphor</span> states that one thing <em>is</em> another: "Time is a thief." A <span class="term">simile</span> uses "like" or "as" to compare: "Time is like a thief." Both are forms of figurative language, but a metaphor creates a stronger, more direct identification between the two ideas.</p>
      <h3>Why does the distinction matter?</h3>
      <p>Metaphors force the reader to accept the comparison as fact, creating a more immersive and emotionally resonant experience. Similes acknowledge the comparison is an analogy, giving the reader slightly more distance. Writers choose between them deliberately to control how forcefully a comparison lands.</p>
    </div>

    <div class="info-block">
      <h2>Tenor, Vehicle, and Ground</h2>
      <p>The linguist I. A. Richards introduced these terms in 1936 to describe the anatomy of a metaphor:</p>
      <ul>
        <li><span class="term">Tenor</span>: the subject being described (e.g. "time" in "Time is a thief")</li>
        <li><span class="term">Vehicle</span>: the image or concept brought in for comparison (e.g. "thief")</li>
        <li><span class="term">Ground</span>: the shared quality that makes the comparison work (e.g. both take things away from you without asking)</li>
      </ul>
      <p>The <span class="term">tension</span> is the difference between tenor and vehicle: the further apart they seem, the more surprising and thought-provoking the metaphor.</p>
    </div>

    <div class="info-block">
      <h2>Extended Metaphor</h2>
      <p>An <span class="term">extended metaphor</span> (or sustained metaphor) develops a single comparison across several sentences, a paragraph, or even an entire work. It deepens the comparison by exploring multiple aspects of the vehicle.</p>
      <h3>Example</h3>
      <p>If "life is a journey," an extended metaphor might describe crossroads as difficult decisions, storms as hardship, fellow travellers as friends, and the destination as one's purpose. Each element of the vehicle maps onto a different aspect of the tenor, creating a rich and coherent figurative framework.</p>
    </div>

    <div class="info-block">
      <h2>Effect on the Reader</h2>
      <p>Figurative language works because it activates the reader's imagination. When you read "anger is a fire," your mind draws on everything you know about fire: its heat, its destructiveness, how it spreads, how it can be controlled or extinguished. These associations transfer to your understanding of anger, creating a richer, more visceral comprehension than a literal description could achieve.</p>
      <p>This is why metaphors are central to persuasive writing, poetry, and rhetoric. They do not merely decorate language; they shape how we think about abstract ideas.</p>
    </div>

    <div class="info-block">
      <h2>Dead Metaphors</h2>
      <p>Some metaphors have been used so frequently that we no longer notice them as figurative: "the leg of a table," "falling in love," "a flood of tears." These are called <span class="term">dead metaphors</span>. They reveal how deeply figurative thinking is embedded in everyday language. Skilled writers avoid dead metaphors in favour of original comparisons that surprise and illuminate.</p>
    </div>
  </div>
</div>

<!-- ══════════ TAB 3: Create Your Own ══════════ -->
<div class="tab-content" id="tab-create">
  <div class="create-panel">
    <div class="create-form">
      <h2>Create Your Own Metaphor</h2>
      <div class="form-row">
        <div class="form-group">
          <label>Your Tenor (the subject)</label>
          <input type="text" id="custom-tenor" placeholder="e.g. loneliness, ambition, memory">
        </div>
        <div class="form-group">
          <label>Your Vehicle (the comparison)</label>
          <input type="text" id="custom-vehicle" placeholder="e.g. desert, ladder, photograph">
        </div>
      </div>
      <div class="form-group" style="margin-bottom: 14px;">
        <label>The Ground (what do they share?)</label>
        <textarea id="custom-ground" placeholder="Explain what quality or experience the tenor and vehicle have in common."></textarea>
      </div>
      <div class="form-group" style="margin-bottom: 14px;">
        <label>Your Metaphor Sentence</label>
        <input type="text" id="custom-sentence" placeholder="e.g. Loneliness is a desert stretching in every direction.">
      </div>
      <div class="form-group" style="margin-bottom: 14px;">
        <label>Effect on the Reader</label>
        <textarea id="custom-effect" placeholder="How does this metaphor make the reader feel or think? What associations does the vehicle bring?"></textarea>
      </div>
      <button class="btn primary" id="btn-save-custom">Save Metaphor</button>
    </div>

    <div class="custom-output" id="custom-gallery">
      <h3>Your Metaphors</h3>
      <div id="custom-list">
        <div class="empty-state">
          <div class="empty-icon">&#9997;</div>
          <p>Your custom metaphors will appear here.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* ══════════════════════════════════════════════════
   DATA
   ══════════════════════════════════════════════════ */
const TENORS = [
  { id: 'heart',     emoji: '\u2764\uFE0F',  label: 'Heart' },
  { id: 'time',      emoji: '\u23F3',        label: 'Time' },
  { id: 'life',      emoji: '\uD83C\uDF3F',  label: 'Life' },
  { id: 'hope',      emoji: '\u2B50',        label: 'Hope' },
  { id: 'anger',     emoji: '\uD83D\uDCA2',  label: 'Anger' },
  { id: 'knowledge', emoji: '\uD83D\uDCDA',  label: 'Knowledge' }
];

const VEHICLES = [
  { id: 'stone',    emoji: '\uD83E\uDEA8', label: 'Stone' },
  { id: 'river',    emoji: '\uD83C\uDF0A', label: 'River' },
  { id: 'journey',  emoji: '\uD83D\uDEE4\uFE0F', label: 'Journey' },
  { id: 'fire',     emoji: '\uD83D\uDD25', label: 'Fire' },
  { id: 'ocean',    emoji: '\uD83C\uDF0D', label: 'Ocean' },
  { id: 'light',    emoji: '\uD83D\uDD2E', label: 'Light' },
  { id: 'cage',     emoji: '\uD83D\uDD12', label: 'Cage' },
  { id: 'mountain', emoji: '\u26F0\uFE0F',  label: 'Mountain' }
];

/* Each pairing: metaphor, simile, ground, effect, literary example + source, canvas colours */
const PAIRINGS = {
  'heart-stone': {
    metaphor: 'His heart was a stone, unmoved by pleas or tears.',
    simile: 'His heart was like a stone, unmoved by pleas or tears.',
    ground: 'Both are associated with coldness, hardness, and an inability to be shaped by external forces. The stone suggests emotional rigidity.',
    effect: 'The reader perceives the character as deeply unfeeling. The weight and permanence of stone implies this emotional hardness is fixed, perhaps irreversible, creating a sense of finality.',
    litExample: '"O, she doth teach the torches to burn bright!" contrasts with hearts turned to stone throughout the play.',
    litSource: 'Shakespeare, Romeo and Juliet',
    colours: { tenor: [200, 60, 60], vehicle: [140, 140, 140] }
  },
  'heart-river': {
    metaphor: 'Her heart was a river, carrying every emotion downstream.',
    simile: 'Her heart was like a river, carrying every emotion downstream.',
    ground: 'Both flow continuously and powerfully. A river cannot be stopped, and neither can deep feeling.',
    effect: 'The reader senses emotional depth and constant movement. The river metaphor suggests the character feels things deeply and that emotions pass through rather than becoming trapped.',
    litExample: '"I am the river\u2019s song, always flowing, never still."',
    litSource: 'Langston Hughes, The Negro Speaks of Rivers (adapted)',
    colours: { tenor: [200, 60, 60], vehicle: [60, 120, 200] }
  },
  'heart-journey': {
    metaphor: 'My heart has been a journey with no map and no compass.',
    simile: 'My heart has been like a journey with no map and no compass.',
    ground: 'Both involve exploration, uncertainty, and the possibility of becoming lost. Emotional life, like travel, has no guaranteed direction.',
    effect: 'The reader empathises with vulnerability. The absence of a map suggests the speaker has been navigating love or grief without guidance, evoking sympathy and recognition.',
    litExample: '"Two roads diverged in a wood" captures the heart at a crossroads.',
    litSource: 'Robert Frost, The Road Not Taken',
    colours: { tenor: [200, 60, 60], vehicle: [160, 130, 80] }
  },
  'heart-fire': {
    metaphor: 'His heart was a fire that consumed everything it touched.',
    simile: 'His heart was like a fire that consumed everything it touched.',
    ground: 'Both generate intense heat and energy. Fire is beautiful but destructive; passionate emotion behaves the same way.',
    effect: 'The reader feels both the warmth and the danger of the character\u2019s passion. There is an implicit warning: fire, unchecked, destroys.',
    litExample: '"My heart\u2019s a stereo, it beats for you" uses a different vehicle, but fire is the classic image of passionate love.',
    litSource: 'Emily Bront\u00EB, Wuthering Heights (thematic)',
    colours: { tenor: [200, 60, 60], vehicle: [240, 160, 30] }
  },
  'heart-ocean': {
    metaphor: 'Her heart was an ocean: beautiful on the surface, terrifying in its depths.',
    simile: 'Her heart was like an ocean: beautiful on the surface, terrifying in its depths.',
    ground: 'Both contain hidden depths. The surface of the ocean conceals powerful currents and darkness below, just as a calm exterior can mask turbulent feeling.',
    effect: 'The reader is drawn into mystery. The ocean suggests vastness, unknowability, and a sublime mixture of beauty and danger.',
    litExample: '"The sea is calm tonight" opens with surface stillness before revealing existential doubt.',
    litSource: 'Matthew Arnold, Dover Beach',
    colours: { tenor: [200, 60, 60], vehicle: [30, 80, 160] }
  },
  'heart-light': {
    metaphor: 'Her heart was a light in a room of shadows.',
    simile: 'Her heart was like a light in a room of shadows.',
    ground: 'Both bring warmth and visibility to dark spaces. Light reveals; a loving heart illuminates the lives of those around it.',
    effect: 'The reader feels hope and comfort. The contrast between light and shadow makes the heart seem precious and essential.',
    litExample: '"She walks in beauty, like the night" inverts the light/dark pairing.',
    litSource: 'Lord Byron, She Walks in Beauty',
    colours: { tenor: [200, 60, 60], vehicle: [240, 220, 100] }
  },
  'heart-cage': {
    metaphor: 'His heart had become a cage, trapping every feeling inside.',
    simile: 'His heart was like a cage, trapping every feeling inside.',
    ground: 'Both confine. A cage prevents escape; an emotionally guarded heart prevents feelings from being expressed or released.',
    effect: 'The reader senses repression and suffering. The metaphor implies the character longs to express emotion but cannot, creating pathos.',
    litExample: '"I know why the caged bird sings" uses the cage as a metaphor for oppression and silenced expression.',
    litSource: 'Maya Angelou, I Know Why the Caged Bird Sings',
    colours: { tenor: [200, 60, 60], vehicle: [100, 100, 100] }
  },
  'heart-mountain': {
    metaphor: 'Her heart was a mountain: immovable, enduring, ancient.',
    simile: 'Her heart was like a mountain: immovable, enduring, ancient.',
    ground: 'Both are associated with permanence, strength, and quiet grandeur. A mountain does not yield to weather; a steadfast heart does not yield to hardship.',
    effect: 'The reader perceives unwavering loyalty or resilience. The scale of the mountain elevates the character, suggesting nobility.',
    litExample: '"The everlasting hills" recur in biblical poetry to signify permanence.',
    litSource: 'Genesis 49:26 (King James Bible)',
    colours: { tenor: [200, 60, 60], vehicle: [90, 120, 80] }
  },
  'time-stone': {
    metaphor: 'Time is a stone, wearing all things smooth with its patient weight.',
    simile: 'Time is like a stone, wearing all things smooth with its patient weight.',
    ground: 'Both erode. Stone grinds slowly; time smooths away sharp edges of memory, grief, and landscape alike.',
    effect: 'The reader feels the slow, inevitable quality of time. There is something both comforting and melancholy in this gradual erasure.',
    litExample: '"Time, the destroyer, is time the preserver."',
    litSource: 'T. S. Eliot, Four Quartets',
    colours: { tenor: [100, 160, 200], vehicle: [140, 140, 140] }
  },
  'time-river': {
    metaphor: 'Time is a river, and we are carried along whether we wish it or not.',
    simile: 'Time is like a river, and we are carried along whether we wish it or not.',
    ground: 'Both flow in one direction and cannot be reversed. You cannot step into the same river twice, nor relive a moment.',
    effect: 'The reader feels the inevitability of change. The current suggests powerlessness, but also the beauty of constant renewal.',
    litExample: '"Time is but the stream I go a-fishing in."',
    litSource: 'Henry David Thoreau, Walden',
    colours: { tenor: [100, 160, 200], vehicle: [60, 120, 200] }
  },
  'time-journey': {
    metaphor: 'Time is a journey, and each year is a mile walked.',
    simile: 'Time is like a journey, and each year is a mile walked.',
    ground: 'Both measure progress by distance covered. A journey has a beginning and an end; so does a human life within time.',
    effect: 'The reader is encouraged to see life as purposeful movement. Each moment becomes a step, implying agency and direction.',
    litExample: '"The years like great black oxen tread the world."',
    litSource: 'W. B. Yeats, The Countess Cathleen',
    colours: { tenor: [100, 160, 200], vehicle: [160, 130, 80] }
  },
  'time-fire': {
    metaphor: 'Time is a fire that burns through every life.',
    simile: 'Time is like a fire that burns through every life.',
    ground: 'Both consume and cannot be undone. Fire reduces things to ash; time reduces them to memory.',
    effect: 'The reader feels urgency and loss. The destructive power of fire makes time seem threatening, pressing the reader to value the present.',
    litExample: '"To-morrow, and to-morrow, and to-morrow, creeps in this petty pace from day to day."',
    litSource: 'Shakespeare, Macbeth',
    colours: { tenor: [100, 160, 200], vehicle: [240, 160, 30] }
  },
  'time-ocean': {
    metaphor: 'Time is an ocean, and we see only the surface of its depths.',
    simile: 'Time is like an ocean, and we see only the surface of its depths.',
    ground: 'Both are vast beyond comprehension. The ocean\u2019s depth mirrors the immeasurable span of geological time.',
    effect: 'The reader is humbled. Human life feels small against the enormity of time, evoking both awe and insignificance.',
    litExample: '"Time is the longest distance between two places."',
    litSource: 'Tennessee Williams, The Glass Menagerie',
    colours: { tenor: [100, 160, 200], vehicle: [30, 80, 160] }
  },
  'time-light': {
    metaphor: 'Time is a light that fades as evening falls.',
    simile: 'Time is like a light that fades as evening falls.',
    ground: 'Both diminish. Light weakens towards dusk; the time remaining in a life grows shorter with age.',
    effect: 'The reader feels a gentle melancholy. The fading light is not violent but inevitable, creating a tender awareness of mortality.',
    litExample: '"Do not go gentle into that good night."',
    litSource: 'Dylan Thomas',
    colours: { tenor: [100, 160, 200], vehicle: [240, 220, 100] }
  },
  'time-cage': {
    metaphor: 'Time is a cage, and we pace within its bars.',
    simile: 'Time is like a cage, and we pace within its bars.',
    ground: 'Both confine. We cannot escape the boundaries time imposes: deadlines, ageing, mortality.',
    effect: 'The reader feels trapped. The cage metaphor transforms time from a neutral phenomenon into something oppressive.',
    litExample: '"Stone walls do not a prison make, nor iron bars a cage" inverts this by arguing the mind transcends confinement.',
    litSource: 'Richard Lovelace, To Althea, from Prison',
    colours: { tenor: [100, 160, 200], vehicle: [100, 100, 100] }
  },
  'time-mountain': {
    metaphor: 'Time is a mountain we climb without ever seeing the summit.',
    simile: 'Time is like a mountain we climb without ever seeing the summit.',
    ground: 'Both involve endurance. A mountain demands persistent effort; living through time demands the same.',
    effect: 'The reader senses both struggle and grandeur. The unseen summit suggests that the purpose of time may remain forever mysterious.',
    litExample: '"Because it is there" captures the human drive to confront immensity.',
    litSource: 'George Mallory (attributed)',
    colours: { tenor: [100, 160, 200], vehicle: [90, 120, 80] }
  },
  'life-stone': {
    metaphor: 'Life is a stone shaped by the waters of experience.',
    simile: 'Life is like a stone shaped by the waters of experience.',
    ground: 'Both are formed gradually by external forces. A river stone is rounded by current; a life is shaped by what happens to it.',
    effect: 'The reader reflects on how experiences, even painful ones, create who we are. The smoothing of the stone is slow and irreversible.',
    litExample: '"We are such stuff as dreams are made on."',
    litSource: 'Shakespeare, The Tempest',
    colours: { tenor: [120, 180, 100], vehicle: [140, 140, 140] }
  },
  'life-river': {
    metaphor: 'Life is a river winding through valleys and gorges.',
    simile: 'Life is like a river winding through valleys and gorges.',
    ground: 'Both follow a course shaped by the landscape. A river twists and turns unpredictably; so does a human life.',
    effect: 'The reader is encouraged to accept unpredictability. The river does not resist the terrain; perhaps we should not resist circumstance.',
    litExample: '"All rivers run to the sea; yet the sea is not full."',
    litSource: 'Ecclesiastes 1:7',
    colours: { tenor: [120, 180, 100], vehicle: [60, 120, 200] }
  },
  'life-journey': {
    metaphor: 'Life is a journey with no return ticket.',
    simile: 'Life is like a journey with no return ticket.',
    ground: 'Both move forward. You cannot go back to yesterday any more than you can un-walk a road.',
    effect: 'The reader feels both liberation and loss. The journey metaphor is hopeful (there is always more ahead) but also irreversible.',
    litExample: '"In the middle of the journey of our life, I came to myself in a dark wood."',
    litSource: 'Dante, Inferno (opening)',
    colours: { tenor: [120, 180, 100], vehicle: [160, 130, 80] }
  },
  'life-fire': {
    metaphor: 'Life is a fire: brief, bright, and leaving only ash.',
    simile: 'Life is like a fire: brief, bright, and leaving only ash.',
    ground: 'Both burn intensely and end. Fire gives warmth and light but cannot last; neither can life.',
    effect: 'The reader is struck by urgency. The ash left behind is a reminder that nothing material endures, pushing the reader towards meaning-making.',
    litExample: '"Out, out, brief candle!" uses the related image of a flame extinguished.',
    litSource: 'Shakespeare, Macbeth',
    colours: { tenor: [120, 180, 100], vehicle: [240, 160, 30] }
  },
  'life-ocean': {
    metaphor: 'Life is an ocean, and we are learning to swim.',
    simile: 'Life is like an ocean, and we are learning to swim.',
    ground: 'Both are vast, unpredictable, and require skill to navigate. The ocean can be calm or stormy; so can existence.',
    effect: 'The reader feels the enormity of living. "Learning to swim" implies vulnerability and growth, suggesting none of us have fully mastered life.',
    litExample: '"The world is too much with us; late and soon, getting and spending, we lay waste our powers."',
    litSource: 'William Wordsworth',
    colours: { tenor: [120, 180, 100], vehicle: [30, 80, 160] }
  },
  'life-light': {
    metaphor: 'Life is a light carried through darkness.',
    simile: 'Life is like a light carried through darkness.',
    ground: 'Both are fragile and precious. Light can be extinguished; life can be ended. Both push back against the void.',
    effect: 'The reader feels both hope and fragility. The darkness around the light makes life seem courageous simply by existing.',
    litExample: '"There is a crack in everything; that\u2019s how the light gets in."',
    litSource: 'Leonard Cohen, Anthem',
    colours: { tenor: [120, 180, 100], vehicle: [240, 220, 100] }
  },
  'life-cage': {
    metaphor: 'Life had become a cage she paced with restless feet.',
    simile: 'Her life was like a cage she paced with restless feet.',
    ground: 'Both confine. When life feels restricted by circumstance, obligation, or illness, it resembles a cage.',
    effect: 'The reader feels claustrophobia and empathy. The pacing suggests energy without outlet, a life that wants more than it has.',
    litExample: '"I know why the caged bird sings" directly equates confinement with silenced potential.',
    litSource: 'Maya Angelou',
    colours: { tenor: [120, 180, 100], vehicle: [100, 100, 100] }
  },
  'life-mountain': {
    metaphor: 'Life is a mountain, and every setback is a false summit.',
    simile: 'Life is like a mountain, and every setback is a false summit.',
    ground: 'Both demand perseverance. Mountains deceive climbers with false summits; life deceives us with apparent endings that are really transitions.',
    effect: 'The reader is motivated. The metaphor acknowledges difficulty but frames it within an upward trajectory, implying progress despite setbacks.',
    litExample: '"I have been to the mountaintop" uses the summit as a metaphor for visionary hope.',
    litSource: 'Martin Luther King Jr.',
    colours: { tenor: [120, 180, 100], vehicle: [90, 120, 80] }
  },
  'hope-stone': {
    metaphor: 'Hope was a stone in his pocket, small but always there.',
    simile: 'Hope was like a stone in his pocket, small but always there.',
    ground: 'Both are solid and persistent. A pocket stone is a touchstone, something you reach for in uncertainty.',
    effect: 'The reader finds comfort. The smallness of the stone suggests that hope need not be grand to sustain us.',
    litExample: '"Hope is the thing with feathers" offers a contrasting, lighter vehicle.',
    litSource: 'Emily Dickinson',
    colours: { tenor: [220, 200, 60], vehicle: [140, 140, 140] }
  },
  'hope-river': {
    metaphor: 'Hope is a river that finds a way around every obstacle.',
    simile: 'Hope is like a river that finds a way around every obstacle.',
    ground: 'Both persist despite barriers. Water flows around rocks; hope persists around despair.',
    effect: 'The reader feels reassured. The river\u2019s patient, unstoppable quality makes hope seem natural and inevitable.',
    litExample: '"Hope springs eternal in the human breast."',
    litSource: 'Alexander Pope, An Essay on Man',
    colours: { tenor: [220, 200, 60], vehicle: [60, 120, 200] }
  },
  'hope-journey': {
    metaphor: 'Hope is a journey begun in the dark, trusting that dawn will come.',
    simile: 'Hope is like a journey begun in the dark, trusting that dawn will come.',
    ground: 'Both require faith in an unseen outcome. Setting out without knowing the way is an act of hope.',
    effect: 'The reader is moved by the courage embedded in hope. Beginning in darkness makes the eventual dawn more powerful.',
    litExample: '"Faith is taking the first step even when you don\u2019t see the whole staircase."',
    litSource: 'Martin Luther King Jr. (attributed)',
    colours: { tenor: [220, 200, 60], vehicle: [160, 130, 80] }
  },
  'hope-fire': {
    metaphor: 'Hope is a fire that refuses to be extinguished.',
    simile: 'Hope is like a fire that refuses to be extinguished.',
    ground: 'Both can survive adverse conditions. An ember can reignite; a flicker of hope can restore purpose.',
    effect: 'The reader feels defiance. The fire\u2019s resistance to extinction makes hope seem heroic and stubborn.',
    litExample: '"A single spark can start a prairie fire."',
    litSource: 'Mao Zedong (proverbial)',
    colours: { tenor: [220, 200, 60], vehicle: [240, 160, 30] }
  },
  'hope-ocean': {
    metaphor: 'Hope is an ocean: look at the horizon and you cannot see where it ends.',
    simile: 'Hope is like an ocean: look at the horizon and you cannot see where it ends.',
    ground: 'Both are boundless. The ocean\u2019s horizon suggests that hope, too, extends beyond what we can currently see.',
    effect: 'The reader is uplifted. Boundlessness transforms hope from a small personal feeling into something universal and infinite.',
    litExample: '"Eternity is in love with the productions of time."',
    litSource: 'William Blake, The Marriage of Heaven and Hell',
    colours: { tenor: [220, 200, 60], vehicle: [30, 80, 160] }
  },
  'hope-light': {
    metaphor: 'Hope is a light at the end of every tunnel.',
    simile: 'Hope is like a light at the end of every tunnel.',
    ground: 'Both guide and promise an end to darkness. Light at a tunnel\u2019s end signals escape and arrival.',
    effect: 'The reader feels reassurance. Though this is a familiar metaphor, its power lies in the universal experience of seeking light in dark times.',
    litExample: '"The light shines in the darkness, and the darkness has not overcome it."',
    litSource: 'John 1:5',
    colours: { tenor: [220, 200, 60], vehicle: [240, 220, 100] }
  },
  'hope-cage': {
    metaphor: 'Hope was a bird in a cage, singing despite its bars.',
    simile: 'Hope was like a bird in a cage, singing despite its bars.',
    ground: 'Both exist within confinement yet persist. A caged bird still sings; hope still flickers even in dire circumstances.',
    effect: 'The reader feels bittersweet admiration. The singing is defiant but the cage is still real, creating emotional complexity.',
    litExample: '"Hope is the thing with feathers that perches in the soul."',
    litSource: 'Emily Dickinson',
    colours: { tenor: [220, 200, 60], vehicle: [100, 100, 100] }
  },
  'hope-mountain': {
    metaphor: 'Hope is a mountain on the horizon, always visible, always distant.',
    simile: 'Hope is like a mountain on the horizon, always visible, always distant.',
    ground: 'Both can be seen from far away but take great effort to reach. Hope sustains us precisely because it is ahead, not behind.',
    effect: 'The reader feels longing and determination. The mountain\u2019s permanence makes hope seem reliable, while its distance acknowledges that fulfilment requires effort.',
    litExample: '"I lift up mine eyes unto the hills, from whence cometh my help."',
    litSource: 'Psalm 121',
    colours: { tenor: [220, 200, 60], vehicle: [90, 120, 80] }
  },
  'anger-stone': {
    metaphor: 'His anger was a stone lodged in his chest, heavy and cold.',
    simile: 'His anger was like a stone lodged in his chest, heavy and cold.',
    ground: 'Both weigh down. Resentment, like a stone carried inside, burdens and hardens the bearer.',
    effect: 'The reader feels the physical weight of unresolved anger. The coldness of stone contrasts with the usual "hot" anger, suggesting a deeper, more dangerous form.',
    litExample: '"I was angry with my friend: I told my wrath, my wrath did end."',
    litSource: 'William Blake, A Poison Tree',
    colours: { tenor: [200, 60, 40], vehicle: [140, 140, 140] }
  },
  'anger-river': {
    metaphor: 'Anger was a river in flood, breaking its banks.',
    simile: 'Anger was like a river in flood, breaking its banks.',
    ground: 'Both overflow when containment fails. A river in flood is destructive and uncontrollable; so is unchecked rage.',
    effect: 'The reader senses imminent destruction. The flood metaphor makes anger feel natural but devastating, something that sweeps everything away.',
    litExample: '"Rage, rage against the dying of the light" captures uncontrollable emotional force.',
    litSource: 'Dylan Thomas',
    colours: { tenor: [200, 60, 40], vehicle: [60, 120, 200] }
  },
  'anger-fire': {
    metaphor: 'His anger was a fire that scorched everyone near him.',
    simile: 'His anger was like a fire that scorched everyone near him.',
    ground: 'Both burn and spread. Fire does not discriminate; anger, once unleashed, hurts indiscriminately.',
    effect: 'The reader feels alarm. The scorching quality makes the character dangerous, and the spread of fire implies collateral damage.',
    litExample: '"Wrath is cruel, and anger is outrageous; but who is able to stand before envy?"',
    litSource: 'Proverbs 27:4',
    colours: { tenor: [200, 60, 40], vehicle: [240, 160, 30] }
  },
  'anger-ocean': {
    metaphor: 'Her anger was an ocean storm, churning beneath a still surface.',
    simile: 'Her anger was like an ocean storm, churning beneath a still surface.',
    ground: 'Both conceal turmoil beneath apparent calm. An ocean storm can be invisible from shore; suppressed anger can be invisible to others.',
    effect: 'The reader is unsettled by the hidden nature of the fury. The contrast between surface and depth creates suspense.',
    litExample: '"Still waters run deep" captures this idea proverbially.',
    litSource: 'English proverb',
    colours: { tenor: [200, 60, 40], vehicle: [30, 80, 160] }
  },
  'anger-cage': {
    metaphor: 'She kept her anger in a cage, rattling its bars at night.',
    simile: 'Her anger was like a caged animal, rattling its bars at night.',
    ground: 'Both are confined but dangerous. A caged beast is still a beast; suppressed anger remains potent.',
    effect: 'The reader feels the tension of containment. The nighttime rattling suggests anger resurfaces when defences are low.',
    litExample: '"I nursed my grudge like a wounded animal."',
    litSource: 'Charlotte Bront\u00EB, Jane Eyre (thematic)',
    colours: { tenor: [200, 60, 40], vehicle: [100, 100, 100] }
  },
  'anger-mountain': {
    metaphor: 'His anger was a mountain: silent, immovable, blocking the way forward.',
    simile: 'His anger was like a mountain: silent, immovable, blocking the way forward.',
    ground: 'Both are obstacles. A mountain blocks a path; deep-seated anger blocks reconciliation and growth.',
    effect: 'The reader perceives an almost geological stubbornness. This anger will not erode quickly; it has the permanence of landscape.',
    litExample: '"If you bring forth what is within you, what you bring forth will save you."',
    litSource: 'Gospel of Thomas (gnostic text)',
    colours: { tenor: [200, 60, 40], vehicle: [90, 120, 80] }
  },
  'knowledge-river': {
    metaphor: 'Knowledge is a river: the deeper you wade, the stronger the current.',
    simile: 'Knowledge is like a river: the deeper you wade, the stronger the current.',
    ground: 'Both have depth and force. Surface knowledge is easy; deep knowledge pulls you into complexity.',
    effect: 'The reader understands that learning is not passive. The current suggests that real understanding requires effort and carries you to unexpected places.',
    litExample: '"Education is not the filling of a pail, but the lighting of a fire."',
    litSource: 'W. B. Yeats (attributed)',
    colours: { tenor: [140, 100, 200], vehicle: [60, 120, 200] }
  },
  'knowledge-light': {
    metaphor: 'Knowledge is a light that banishes the shadows of ignorance.',
    simile: 'Knowledge is like a light that banishes the shadows of ignorance.',
    ground: 'Both illuminate. Light reveals what was hidden; knowledge reveals what was misunderstood.',
    effect: 'The reader feels empowered. The Enlightenment metaphor (knowledge as light) is foundational to Western intellectual tradition.',
    litExample: '"The light of the body is the eye: if therefore thine eye be single, thy whole body shall be full of light."',
    litSource: 'Matthew 6:22',
    colours: { tenor: [140, 100, 200], vehicle: [240, 220, 100] }
  },
  'knowledge-fire': {
    metaphor: 'Knowledge is a fire: once lit, it spreads from mind to mind.',
    simile: 'Knowledge is like a fire: once lit, it spreads from mind to mind.',
    ground: 'Both propagate. Fire leaps from surface to surface; ideas leap from person to person.',
    effect: 'The reader senses both the power and danger of knowledge. Fire can illuminate or destroy; knowledge can liberate or be weaponised.',
    litExample: '"A little learning is a dangerous thing."',
    litSource: 'Alexander Pope, An Essay on Criticism',
    colours: { tenor: [140, 100, 200], vehicle: [240, 160, 30] }
  },
  'knowledge-ocean': {
    metaphor: 'Knowledge is an ocean, and I have gathered only a handful of water.',
    simile: 'Knowledge is like an ocean, and I have gathered only a handful of water.',
    ground: 'Both are inexhaustible. No individual can contain all knowledge, just as no vessel can hold the sea.',
    effect: 'The reader is humbled. The metaphor encourages intellectual humility and a recognition that learning never ends.',
    litExample: '"I was like a boy playing on the sea-shore, whilst the great ocean of truth lay undiscovered before me."',
    litSource: 'Isaac Newton (attributed)',
    colours: { tenor: [140, 100, 200], vehicle: [30, 80, 160] }
  },
  'knowledge-mountain': {
    metaphor: 'Knowledge is a mountain: the higher you climb, the further you see.',
    simile: 'Knowledge is like a mountain: the higher you climb, the further you see.',
    ground: 'Both reward effort with perspective. Altitude grants a wider view; deeper learning grants broader understanding.',
    effect: 'The reader is motivated. The summit represents mastery, and the expanding view represents the growing interconnection of ideas.',
    litExample: '"If I have seen further, it is by standing on the shoulders of giants."',
    litSource: 'Isaac Newton',
    colours: { tenor: [140, 100, 200], vehicle: [90, 120, 80] }
  },
  'knowledge-cage': {
    metaphor: 'Without curiosity, knowledge becomes a cage of certainty.',
    simile: 'Without curiosity, knowledge is like a cage of certainty.',
    ground: 'Both can confine. When we stop questioning what we know, our knowledge imprisons us in fixed thinking.',
    effect: 'The reader is challenged. This inversion (knowledge as restriction) is provocative, urging open-mindedness.',
    litExample: '"The only true wisdom is in knowing you know nothing."',
    litSource: 'Socrates (via Plato)',
    colours: { tenor: [140, 100, 200], vehicle: [100, 100, 100] }
  },
  'knowledge-stone': {
    metaphor: 'Knowledge is a stone, building understanding brick by brick.',
    simile: 'Knowledge is like a stone, building understanding brick by brick.',
    ground: 'Both are foundational materials. Stone builds walls and arches; facts and concepts build comprehension.',
    effect: 'The reader visualises learning as construction: patient, cumulative, and structural.',
    litExample: '"Upon this rock I will build my church" uses stone as a foundation metaphor.',
    litSource: 'Matthew 16:18',
    colours: { tenor: [140, 100, 200], vehicle: [140, 140, 140] }
  },
  'knowledge-journey': {
    metaphor: 'Knowledge is a journey with no final destination.',
    simile: 'Knowledge is like a journey with no final destination.',
    ground: 'Both unfold over time. There is always more to discover; the journey metaphor suggests learning is a lifelong process.',
    effect: 'The reader embraces process over product. The absence of a destination removes the pressure of completion and celebrates curiosity.',
    litExample: '"It is good to have an end to journey toward; but it is the journey that matters, in the end."',
    litSource: 'Ursula K. Le Guin',
    colours: { tenor: [140, 100, 200], vehicle: [160, 130, 80] }
  },
  /* Fill remaining combos with defaults */
  'anger-light': {
    metaphor: 'His anger was a blinding light, white-hot and impossible to look at directly.',
    simile: 'His anger was like a blinding light, white-hot and impossible to look at directly.',
    ground: 'Both can overwhelm the senses. An intense light forces you to look away; intense anger forces others to withdraw.',
    effect: 'The reader flinches. The metaphor makes anger feel physically dangerous, as though proximity could cause harm.',
    litExample: '"His countenance was like the sun shining in its full strength" evokes overwhelming radiance.',
    litSource: 'Revelation 1:16',
    colours: { tenor: [200, 60, 40], vehicle: [240, 220, 100] }
  },
  'anger-journey': {
    metaphor: 'His anger was a journey with no destination, wandering deeper into bitterness.',
    simile: 'His anger was like a journey with no destination, wandering deeper into bitterness.',
    ground: 'Both can lack purpose. Unresolved anger goes nowhere productive, circling and deepening.',
    effect: 'The reader senses futility. The aimless journey makes anger seem exhausting and self-destructive.',
    litExample: '"He wandered lonely as a cloud" captures aimless emotional drift.',
    litSource: 'William Wordsworth (adapted context)',
    colours: { tenor: [200, 60, 40], vehicle: [160, 130, 80] }
  },
  'hope-stone': {
    metaphor: 'Hope was a stone in his pocket, small but always there.',
    simile: 'Hope was like a stone in his pocket, small but always there.',
    ground: 'Both are solid and persistent. A pocket stone is a touchstone, something you reach for in uncertainty.',
    effect: 'The reader finds comfort. The smallness of the stone suggests that hope need not be grand to sustain us.',
    litExample: '"Hope is the thing with feathers" offers a contrasting, lighter vehicle.',
    litSource: 'Emily Dickinson',
    colours: { tenor: [220, 200, 60], vehicle: [140, 140, 140] }
  }
};

/* ══════════════════════════════════════════════════
   STATE
   ══════════════════════════════════════════════════ */
let selectedTenor = null;
let selectedVehicle = null;
let currentPairing = null;
let morphValue = 0;
let animFrame = null;
let customMetaphors = [];

/* ══════════════════════════════════════════════════
   INIT
   ══════════════════════════════════════════════════ */
document.addEventListener('DOMContentLoaded', () => {
  buildCards();
  setupTabs();
  setupDropZones();
  setupButtons();
  setupCustomForm();
});

/* ── Tabs ── */
function setupTabs() {
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      btn.classList.add('active');
      document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
    });
  });
}

/* ── Build Cards ── */
function buildCards() {
  const tGrid = document.getElementById('tenor-grid');
  const vGrid = document.getElementById('vehicle-grid');

  TENORS.forEach(t => {
    const card = makeCard(t, 'tenor');
    tGrid.appendChild(card);
  });
  VEHICLES.forEach(v => {
    const card = makeCard(v, 'vehicle');
    vGrid.appendChild(card);
  });
}

function makeCard(item, type) {
  const el = document.createElement('div');
  el.className = `card ${type}`;
  el.draggable = true;
  el.dataset.id = item.id;
  el.dataset.type = type;
  el.innerHTML = `<span class="card-emoji">${item.emoji}</span><span class="card-label">${item.label}</span>`;

  el.addEventListener('dragstart', e => {
    e.dataTransfer.setData('text/plain', JSON.stringify({ id: item.id, type, emoji: item.emoji, label: item.label }));
    el.classList.add('dragging');
  });
  el.addEventListener('dragend', () => el.classList.remove('dragging'));

  /* Click to select (mobile-friendly) */
  el.addEventListener('click', () => {
    if (type === 'tenor') {
      document.querySelectorAll('.card.tenor').forEach(c => c.classList.remove('selected'));
      el.classList.add('selected');
      placeTenor(item);
    } else {
      document.querySelectorAll('.card.vehicle').forEach(c => c.classList.remove('selected'));
      el.classList.add('selected');
      placeVehicle(item);
    }
  });

  return el;
}

/* ── Drop Zones ── */
function setupDropZones() {
  const tDrop = document.getElementById('tenor-drop');
  const vDrop = document.getElementById('vehicle-drop');

  [tDrop, vDrop].forEach(zone => {
    zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('drag-over'); });
    zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
    zone.addEventListener('drop', e => {
      e.preventDefault();
      zone.classList.remove('drag-over');
      try {
        const data = JSON.parse(e.dataTransfer.getData('text/plain'));
        if (data.type === 'tenor' && zone === tDrop) placeTenor(data);
        else if (data.type === 'vehicle' && zone === vDrop) placeVehicle(data);
        else if (data.type === 'tenor' && zone === vDrop) { /* wrong zone, ignore */ }
        else if (data.type === 'vehicle' && zone === tDrop) { /* wrong zone, ignore */ }
      } catch(err) {}
    });
  });
}

function placeTenor(item) {
  selectedTenor = item;
  const zone = document.getElementById('tenor-drop');
  zone.innerHTML = `<span class="zone-emoji">${item.emoji}</span><span class="zone-name">${item.label}</span>`;
  zone.classList.add('filled');
  updateGenerateBtn();
}

function placeVehicle(item) {
  selectedVehicle = item;
  const zone = document.getElementById('vehicle-drop');
  zone.innerHTML = `<span class="zone-emoji">${item.emoji}</span><span class="zone-name">${item.label}</span>`;
  zone.classList.add('filled');
  updateGenerateBtn();
}

function updateGenerateBtn() {
  const canGenerate = selectedTenor && selectedVehicle;
  document.getElementById('btn-generate').disabled = !canGenerate;
  document.getElementById('btn-simile').disabled = !canGenerate;
}

/* ── Buttons ── */
function setupButtons() {
  document.getElementById('btn-generate').addEventListener('click', () => generate(false));
  document.getElementById('btn-simile').addEventListener('click', () => generate(true));
  document.getElementById('btn-clear').addEventListener('click', clearPairing);
  document.getElementById('morph-slider').addEventListener('input', e => {
    morphValue = parseInt(e.target.value) / 100;
    drawCanvas();
  });
}

function clearPairing() {
  selectedTenor = null;
  selectedVehicle = null;
  currentPairing = null;

  const tZone = document.getElementById('tenor-drop');
  tZone.innerHTML = '<span class="zone-label">Tenor</span>';
  tZone.classList.remove('filled');

  const vZone = document.getElementById('vehicle-drop');
  vZone.innerHTML = '<span class="zone-label">Vehicle</span>';
  vZone.classList.remove('filled');

  document.querySelectorAll('.card').forEach(c => c.classList.remove('selected'));
  document.getElementById('canvas-area').style.display = 'none';
  document.getElementById('result-area').innerHTML = '';
  document.getElementById('morph-slider').value = 0;
  morphValue = 0;
  updateGenerateBtn();
  if (animFrame) cancelAnimationFrame(animFrame);
}

/* ══════════════════════════════════════════════════
   GENERATE
   ══════════════════════════════════════════════════ */
function generate(asSimile) {
  if (!selectedTenor || !selectedVehicle) return;

  const key = selectedTenor.id + '-' + selectedVehicle.id;
  const data = PAIRINGS[key];

  if (!data) {
    document.getElementById('result-area').innerHTML = `
      <div class="result-panel">
        <div class="empty-state">
          <div class="empty-icon">&#129300;</div>
          <p>This pairing does not have a pre-written analysis yet. Try another combination, or use the "Create Your Own" tab to write your own metaphor for this pairing.</p>
        </div>
      </div>`;
    document.getElementById('canvas-area').style.display = 'none';
    return;
  }

  currentPairing = data;

  /* Show canvas */
  document.getElementById('canvas-area').style.display = 'block';
  document.getElementById('morph-slider').value = 0;
  morphValue = 0;
  drawCanvas();
  autoMorph();

  /* Show result */
  const sentence = asSimile ? data.simile : data.metaphor;
  const typeLabel = asSimile ? 'Simile' : 'Metaphor';

  document.getElementById('result-area').innerHTML = `
    <div class="result-panel">
      <h3>${typeLabel}: ${selectedTenor.label} &amp; ${selectedVehicle.label}</h3>
      <div class="metaphor-sentence">"${sentence}"</div>

      <div class="explanation-section">
        <h4>The Ground (shared quality)</h4>
        <p>${data.ground}</p>
      </div>

      <div class="explanation-section">
        <h4>Effect on the Reader</h4>
        <p>${data.effect}</p>
      </div>

      <div class="explanation-section">
        <h4>Literary Connection</h4>
        <div class="lit-example">
          ${data.litExample}
          <div class="lit-source">${data.litSource}</div>
        </div>
      </div>
    </div>`;
}

/* ══════════════════════════════════════════════════
   CANVAS DRAWING
   ══════════════════════════════════════════════════ */
function drawCanvas() {
  const canvas = document.getElementById('blend-canvas');
  const ctx = canvas.getContext('2d');
  const w = canvas.width;
  const h = canvas.height;
  const t = morphValue;

  if (!currentPairing) return;

  const tc = currentPairing.colours.tenor;
  const vc = currentPairing.colours.vehicle;

  /* Background gradient blending */
  const bgR = Math.round(tc[0] * (1 - t) * 0.15 + vc[0] * t * 0.15 + 20);
  const bgG = Math.round(tc[1] * (1 - t) * 0.15 + vc[1] * t * 0.15 + 15);
  const bgB = Math.round(tc[2] * (1 - t) * 0.15 + vc[2] * t * 0.15 + 12);
  ctx.fillStyle = `rgb(${bgR},${bgG},${bgB})`;
  ctx.fillRect(0, 0, w, h);

  /* Draw floating particles */
  const time = Date.now() * 0.001;
  const particleCount = 40;

  for (let i = 0; i < particleCount; i++) {
    const seed = i * 137.508;
    const px = (Math.sin(seed + time * 0.3) * 0.5 + 0.5) * w;
    const py = (Math.cos(seed * 0.7 + time * 0.2) * 0.5 + 0.5) * h;
    const size = 2 + Math.sin(seed) * 3 + t * 4;

    const pR = Math.round(tc[0] * (1 - t) + vc[0] * t);
    const pG = Math.round(tc[1] * (1 - t) + vc[1] * t);
    const pB = Math.round(tc[2] * (1 - t) + vc[2] * t);
    const alpha = 0.3 + Math.sin(time + seed) * 0.2;

    ctx.beginPath();
    ctx.arc(px, py, size, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(${pR},${pG},${pB},${alpha})`;
    ctx.fill();
  }

  /* Central morphing shape */
  const cx = w / 2;
  const cy = h / 2;

  /* Tenor shape: circle. Vehicle shape: polygon with edges based on vehicle. Morph between them. */
  const sides = 4 + Math.round(t * 4); /* circle-ish to octagon-ish */
  const baseRadius = 50 + t * 20;

  ctx.beginPath();
  for (let i = 0; i <= 60; i++) {
    const angle = (i / 60) * Math.PI * 2;
    /* Morph from circle to angular shape */
    const circleR = baseRadius;
    const polyR = baseRadius * (0.8 + 0.3 * Math.cos(angle * sides + time));
    const r = circleR * (1 - t) + polyR * t;

    const x = cx + Math.cos(angle) * r;
    const y = cy + Math.sin(angle) * r;
    if (i === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  }
  ctx.closePath();

  const gradCx = cx;
  const gradCy = cy;
  const grad = ctx.createRadialGradient(gradCx, gradCy, 0, gradCx, gradCy, baseRadius + 30);
  const cR = Math.round(tc[0] * (1 - t) + vc[0] * t);
  const cG = Math.round(tc[1] * (1 - t) + vc[1] * t);
  const cB = Math.round(tc[2] * (1 - t) + vc[2] * t);
  grad.addColorStop(0, `rgba(${cR},${cG},${cB},0.9)`);
  grad.addColorStop(0.6, `rgba(${cR},${cG},${cB},0.4)`);
  grad.addColorStop(1, `rgba(${cR},${cG},${cB},0.05)`);
  ctx.fillStyle = grad;
  ctx.fill();

  /* Orbiting elements */
  const orbitCount = 6;
  for (let i = 0; i < orbitCount; i++) {
    const oAngle = (i / orbitCount) * Math.PI * 2 + time * (0.5 + t * 0.5);
    const oRadius = 80 + t * 30 + Math.sin(time + i) * 10;
    const ox = cx + Math.cos(oAngle) * oRadius;
    const oy = cy + Math.sin(oAngle) * oRadius;
    const oSize = 4 + t * 6;

    ctx.beginPath();
    ctx.arc(ox, oy, oSize, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(${vc[0]},${vc[1]},${vc[2]},${0.3 + t * 0.5})`;
    ctx.fill();

    /* Connection lines */
    ctx.beginPath();
    ctx.moveTo(cx, cy);
    ctx.lineTo(ox, oy);
    ctx.strokeStyle = `rgba(${cR},${cG},${cB},${0.05 + t * 0.15})`;
    ctx.lineWidth = 1;
    ctx.stroke();
  }

  /* Labels */
  ctx.font = '13px Georgia, serif';
  ctx.textAlign = 'center';

  /* Tenor label (left, fading) */
  ctx.fillStyle = `rgba(${tc[0]},${tc[1]},${tc[2]},${0.9 - t * 0.6})`;
  ctx.fillText(selectedTenor ? selectedTenor.label : '', w * 0.15, h - 20);

  /* Vehicle label (right, appearing) */
  ctx.fillStyle = `rgba(${vc[0]},${vc[1]},${vc[2]},${0.2 + t * 0.7})`;
  ctx.fillText(selectedVehicle ? selectedVehicle.label : '', w * 0.85, h - 20);

  /* Centre label */
  const blendLabel = t < 0.3 ? 'Literal' : t < 0.7 ? 'Blending...' : 'Figurative';
  ctx.fillStyle = `rgba(212,168,67,${0.6 + t * 0.4})`;
  ctx.font = '14px "Segoe UI", sans-serif';
  ctx.fillText(blendLabel, cx, h - 16);
}

function autoMorph() {
  const slider = document.getElementById('morph-slider');
  let val = 0;
  const duration = 2000;
  const start = performance.now();

  function step(ts) {
    const elapsed = ts - start;
    val = Math.min(elapsed / duration, 1);
    morphValue = val;
    slider.value = Math.round(val * 100);
    drawCanvas();
    if (val < 1) {
      animFrame = requestAnimationFrame(step);
    } else {
      /* Continue idle animation */
      idleAnimate();
    }
  }
  if (animFrame) cancelAnimationFrame(animFrame);
  animFrame = requestAnimationFrame(step);
}

function idleAnimate() {
  drawCanvas();
  animFrame = requestAnimationFrame(idleAnimate);
}

/* ══════════════════════════════════════════════════
   CREATE YOUR OWN
   ══════════════════════════════════════════════════ */
function setupCustomForm() {
  document.getElementById('btn-save-custom').addEventListener('click', () => {
    const tenor = document.getElementById('custom-tenor').value.trim();
    const vehicle = document.getElementById('custom-vehicle').value.trim();
    const ground = document.getElementById('custom-ground').value.trim();
    const sentence = document.getElementById('custom-sentence').value.trim();
    const effect = document.getElementById('custom-effect').value.trim();

    if (!tenor || !vehicle || !sentence) {
      alert('Please fill in at least the tenor, vehicle, and metaphor sentence.');
      return;
    }

    customMetaphors.push({ tenor, vehicle, ground, sentence, effect });
    renderCustomList();

    /* Clear form */
    document.getElementById('custom-tenor').value = '';
    document.getElementById('custom-vehicle').value = '';
    document.getElementById('custom-ground').value = '';
    document.getElementById('custom-sentence').value = '';
    document.getElementById('custom-effect').value = '';
  });
}

function renderCustomList() {
  const container = document.getElementById('custom-list');
  if (customMetaphors.length === 0) {
    container.innerHTML = '<div class="empty-state"><div class="empty-icon">&#9997;</div><p>Your custom metaphors will appear here.</p></div>';
    return;
  }

  container.innerHTML = customMetaphors.map((m, i) => `
    <div class="result-panel" style="margin-bottom: 14px;">
      <h3>${m.tenor} &amp; ${m.vehicle}</h3>
      <div class="metaphor-sentence">"${escapeHtml(m.sentence)}"</div>
      ${m.ground ? `<div class="explanation-section"><h4>The Ground</h4><p>${escapeHtml(m.ground)}</p></div>` : ''}
      ${m.effect ? `<div class="explanation-section"><h4>Effect on the Reader</h4><p>${escapeHtml(m.effect)}</p></div>` : ''}
      <button class="btn" onclick="removeCustom(${i})" style="margin-top:8px; font-size:0.8rem;">Remove</button>
    </div>
  `).join('');
}

function removeCustom(index) {
  customMetaphors.splice(index, 1);
  renderCustomList();
}

function escapeHtml(str) {
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
}
</script>
</body>
</html>