<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Historical Empathy Builder</title>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --navy:#0f1a2e;--navy-light:#1a2a4a;--navy-mid:#152240;
  --gold:#d4a843;--gold-light:#f0d080;--gold-dim:#a07830;
  --parchment:#f5f0e1;--parchment-dark:#e8dfc8;
  --white:#f0ece4;--text:#ddd8cc;--muted:#8a8577;
  --card-bg:#1e2f50;--card-border:#2a4070;
  --panel-bg:#141e34;--panel-border:#253560;
  --accent-red:#c0392b;--accent-green:#27ae60;--accent-blue:#2980b9;--accent-purple:#8e44ad;
  --radius:8px;--shadow:0 4px 20px rgba(0,0,0,.4);
  --transition:all .3s ease;
}
html{scroll-behavior:smooth}
body{min-height:100vh;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:var(--navy);color:var(--text);line-height:1.6}
button{cursor:pointer;font-family:inherit;border:none;border-radius:var(--radius);transition:var(--transition)}
button:hover{filter:brightness(1.15)}
textarea{font-family:inherit;border-radius:var(--radius);border:1px solid var(--panel-border);background:var(--navy-mid);color:var(--text);padding:10px 14px;outline:none;resize:vertical;width:100%}
textarea:focus{border-color:var(--gold);box-shadow:0 0 0 2px rgba(212,168,67,.2)}

/* HEADER */
header{position:sticky;top:0;z-index:100;background:linear-gradient(135deg,#0c1524,#162040);border-bottom:2px solid var(--gold-dim);padding:14px 24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px}
header h1{font-size:1.4rem;color:var(--gold);letter-spacing:1px;font-weight:700}
header h1 span{color:var(--gold-light);font-weight:400;font-size:.82rem;margin-left:10px;opacity:.75}
.header-btns{display:flex;gap:8px;align-items:center}
.hbtn{background:var(--navy-light);color:var(--gold);padding:8px 16px;font-size:.8rem;border:1px solid var(--gold-dim);border-radius:var(--radius)}
.hbtn:hover{background:var(--gold-dim);color:#fff}
.hbtn.active{background:var(--gold-dim);color:#fff}

/* MAIN LAYOUT */
main{max-width:960px;margin:0 auto;padding:20px 16px 60px}

/* SCENARIO SELECTOR */
.scenario-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin-bottom:24px}
.scenario-card{background:var(--card-bg);border:1px solid var(--card-border);border-radius:var(--radius);padding:18px 16px;cursor:pointer;transition:var(--transition);position:relative;overflow:hidden}
.scenario-card::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--gold);transition:var(--transition)}
.scenario-card:hover{background:#243858;transform:translateY(-2px);box-shadow:var(--shadow)}
.scenario-card:hover::before{width:6px}
.scenario-card.selected{border-color:var(--gold);background:#1c3360}
.scenario-card.selected::before{width:6px;background:var(--gold-light)}
.scenario-card .sc-date{font-size:.68rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--gold);margin-bottom:6px;font-weight:600}
.scenario-card .sc-title{font-size:1rem;font-weight:700;color:var(--white);margin-bottom:6px}
.scenario-card .sc-desc{font-size:.78rem;color:var(--muted);line-height:1.4}
.scenario-card .sc-icon{font-size:1.8rem;margin-bottom:8px}

/* SECTION TITLES */
.section-title{font-size:.75rem;text-transform:uppercase;letter-spacing:2px;color:var(--gold);margin:28px 0 14px;padding-bottom:8px;border-bottom:1px solid var(--panel-border);display:flex;align-items:center;gap:8px}
.section-title .dot{width:8px;height:8px;border-radius:50%;background:var(--gold)}

/* CONTEXT CARDS */
.context-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px;margin-bottom:20px}
.context-card{background:linear-gradient(145deg,#1a2d4d,#1e3355);border:1px solid var(--card-border);border-radius:var(--radius);padding:18px;position:relative;overflow:hidden}
.context-card::after{content:'';position:absolute;top:0;right:0;width:60px;height:60px;background:radial-gradient(circle at top right,rgba(212,168,67,.08),transparent);pointer-events:none}
.context-card h3{font-size:.88rem;color:var(--gold-light);margin-bottom:8px;display:flex;align-items:center;gap:8px}
.context-card h3 .ctx-icon{font-size:1.1rem}
.context-card p{font-size:.82rem;color:var(--text);line-height:1.55}
.context-card .note{font-size:.72rem;color:var(--gold-dim);margin-top:8px;font-style:italic;padding-top:6px;border-top:1px solid var(--panel-border)}

/* DECISION PANEL */
.decision-panel{background:var(--panel-bg);border:1px solid var(--panel-border);border-radius:var(--radius);padding:24px;margin-bottom:20px}
.decision-prompt{font-size:1.05rem;color:var(--white);font-weight:600;margin-bottom:16px;line-height:1.5}
.option-list{display:flex;flex-direction:column;gap:10px;margin-bottom:20px}
.option-btn{background:var(--card-bg);border:2px solid var(--card-border);border-radius:var(--radius);padding:14px 18px;text-align:left;color:var(--text);font-size:.88rem;line-height:1.5;transition:var(--transition)}
.option-btn:hover{border-color:var(--gold);background:#1c3360;filter:none}
.option-btn.chosen{border-color:var(--gold);background:#1c3360;box-shadow:inset 0 0 0 1px var(--gold-dim)}
.option-btn .opt-label{font-weight:700;color:var(--gold-light);margin-right:6px}
.reasoning-area{margin-top:16px}
.reasoning-area label{display:block;font-size:.82rem;color:var(--gold);margin-bottom:6px;font-weight:600}
.reasoning-area textarea{min-height:100px;font-size:.85rem;line-height:1.55}
.submit-row{display:flex;justify-content:flex-end;margin-top:14px}
.submit-btn{background:var(--gold-dim);color:#fff;padding:10px 28px;font-size:.9rem;font-weight:600;border-radius:var(--radius)}
.submit-btn:disabled{opacity:.4;cursor:not-allowed;filter:none}
.submit-btn:hover:not(:disabled){background:var(--gold)}

/* REVEAL SECTION */
.reveal-section{display:none}
.reveal-section.visible{display:block}
.reveal-box{background:linear-gradient(145deg,#162040,#1a2850);border:1px solid var(--gold-dim);border-radius:var(--radius);padding:24px;margin-bottom:20px}
.reveal-box h3{color:var(--gold-light);font-size:1rem;margin-bottom:10px}
.reveal-box p{font-size:.85rem;line-height:1.6;margin-bottom:8px}

/* TIMELINE */
.timeline{position:relative;padding-left:28px;margin:16px 0}
.timeline::before{content:'';position:absolute;left:8px;top:0;bottom:0;width:2px;background:var(--gold-dim)}
.timeline-item{position:relative;margin-bottom:16px;padding-left:8px}
.timeline-item::before{content:'';position:absolute;left:-24px;top:6px;width:12px;height:12px;border-radius:50%;background:var(--gold);border:2px solid var(--navy)}
.timeline-item .tl-date{font-size:.72rem;color:var(--gold);font-weight:600;text-transform:uppercase;letter-spacing:1px}
.timeline-item .tl-text{font-size:.82rem;color:var(--text);margin-top:2px}

/* REFLECTION SECTION */
.reflection-grid{display:flex;flex-direction:column;gap:14px;margin-bottom:20px}
.reflection-card{background:var(--card-bg);border:1px solid var(--card-border);border-radius:var(--radius);padding:18px}
.reflection-card .ref-question{font-size:.9rem;color:var(--gold-light);font-weight:600;margin-bottom:10px;line-height:1.5}
.reflection-card textarea{min-height:70px;font-size:.82rem}

/* FEEDBACK */
.feedback-panel{background:linear-gradient(145deg,#1a3050,#1e3860);border:1px solid var(--gold);border-radius:var(--radius);padding:24px;margin-bottom:20px;display:none}
.feedback-panel.visible{display:block}
.feedback-panel h3{color:var(--gold-light);font-size:1.05rem;margin-bottom:12px}
.feedback-panel p{font-size:.85rem;line-height:1.6;margin-bottom:10px}
.score-display{display:flex;align-items:center;gap:16px;padding:16px;background:rgba(212,168,67,.08);border-radius:var(--radius);margin-bottom:14px}
.score-circle{width:56px;height:56px;border-radius:50%;border:3px solid var(--gold);display:flex;align-items:center;justify-content:center;font-size:1.2rem;font-weight:700;color:var(--gold-light)}
.score-label{font-size:.85rem;color:var(--text)}
.score-label strong{color:var(--gold-light);display:block;margin-bottom:2px}

/* INFO PANEL (OVERLAY) */
.info-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(10,15,30,.85);z-index:200;display:none;align-items:center;justify-content:center;padding:20px}
.info-overlay.open{display:flex}
.info-box{background:var(--panel-bg);border:1px solid var(--gold-dim);border-radius:12px;max-width:620px;width:100%;max-height:85vh;overflow-y:auto;padding:32px;position:relative}
.info-box::-webkit-scrollbar{width:6px}
.info-box::-webkit-scrollbar-thumb{background:var(--gold-dim);border-radius:3px}
.info-box h2{color:var(--gold);font-size:1.2rem;margin-bottom:16px}
.info-box h3{color:var(--gold-light);font-size:.95rem;margin:18px 0 8px}
.info-box p{font-size:.85rem;color:var(--text);line-height:1.65;margin-bottom:10px}
.info-box .close-btn{position:absolute;top:14px;right:14px;background:none;color:var(--muted);font-size:1.3rem;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:50%}
.info-box .close-btn:hover{color:var(--gold);background:var(--navy-light)}
.info-box .key-term{background:rgba(212,168,67,.1);border-left:3px solid var(--gold);padding:10px 14px;border-radius:0 var(--radius) var(--radius) 0;margin:12px 0;font-size:.84rem;line-height:1.55}
.info-box .key-term strong{color:var(--gold-light)}

/* PROGRESS */
.step-indicator{display:flex;align-items:center;gap:4px;margin-bottom:24px}
.step-dot{width:10px;height:10px;border-radius:50%;background:var(--panel-border);transition:var(--transition)}
.step-dot.active{background:var(--gold);box-shadow:0 0 6px rgba(212,168,67,.4)}
.step-dot.done{background:var(--accent-green)}
.step-label{font-size:.72rem;color:var(--muted);margin-left:8px;text-transform:uppercase;letter-spacing:1px}

/* RESPONSIVE */
@media(max-width:700px){
  header{padding:10px 14px}
  header h1{font-size:1.1rem}
  header h1 span{display:none}
  main{padding:14px 10px 40px}
  .scenario-grid{grid-template-columns:1fr}
  .context-grid{grid-template-columns:1fr}
  .decision-panel{padding:16px}
  .info-box{padding:20px}
}
@media(max-width:480px){
  header h1{font-size:1rem}
  .scenario-card{padding:14px 12px}
  .context-card{padding:14px}
}
</style>
</head>
<body>

<header>
  <h1>Historical Empathy Builder <span>Step into their shoes</span></h1>
  <div class="header-btns">
    <button class="hbtn" onclick="openInfo()">What is Historical Empathy?</button>
    <button class="hbtn" id="resetBtn" onclick="resetAll()" style="display:none">New Scenario</button>
  </div>
</header>

<main id="mainContent">
  <!-- STEP 1: SCENARIO SELECT -->
  <div id="step-select">
    <div class="section-title"><span class="dot"></span>Choose a Historical Scenario</div>
    <div class="scenario-grid" id="scenarioGrid"></div>
  </div>

  <!-- STEP 2: CONTEXT -->
  <div id="step-context" style="display:none">
    <div class="step-indicator" id="stepIndicator">
      <div class="step-dot active"></div>
      <div class="step-dot"></div>
      <div class="step-dot"></div>
      <div class="step-dot"></div>
      <span class="step-label">Context</span>
    </div>

    <div class="section-title"><span class="dot"></span><span id="contextTitle">Context</span></div>
    <p id="contextIntro" style="font-size:.88rem;color:var(--muted);margin-bottom:16px;line-height:1.6"></p>
    <div class="context-grid" id="contextGrid"></div>

    <div style="display:flex;justify-content:flex-end;margin-top:8px">
      <button class="submit-btn" onclick="goToDecision()">Proceed to Decision Point</button>
    </div>
  </div>

  <!-- STEP 3: DECISION -->
  <div id="step-decision" style="display:none">
    <div class="step-indicator" id="stepIndicator2">
      <div class="step-dot done"></div>
      <div class="step-dot active"></div>
      <div class="step-dot"></div>
      <div class="step-dot"></div>
      <span class="step-label">Decision</span>
    </div>

    <div class="section-title"><span class="dot"></span>The Decision Point</div>
    <div class="decision-panel">
      <div class="decision-prompt" id="decisionPrompt"></div>
      <div class="option-list" id="optionList"></div>
      <div class="reasoning-area">
        <label>Explain your reasoning. Why would you choose this option, given what was known at the time?</label>
        <textarea id="reasoningText" placeholder="Think about the pressures, beliefs, and limited information available. Write at least two sentences explaining your choice..."></textarea>
      </div>
      <div class="submit-row">
        <button class="submit-btn" id="submitDecision" onclick="submitDecision()" disabled>Submit Your Decision</button>
      </div>
    </div>
  </div>

  <!-- STEP 4: REVEAL -->
  <div id="step-reveal" style="display:none">
    <div class="step-indicator" id="stepIndicator3">
      <div class="step-dot done"></div>
      <div class="step-dot done"></div>
      <div class="step-dot active"></div>
      <div class="step-dot"></div>
      <span class="step-label">Reveal</span>
    </div>

    <div class="section-title"><span class="dot"></span>What Actually Happened</div>
    <div class="reveal-box">
      <h3 id="revealTitle"></h3>
      <p id="revealText"></p>
    </div>

    <div class="section-title"><span class="dot"></span>Consequences Timeline</div>
    <div class="timeline" id="timeline"></div>

    <div style="display:flex;justify-content:flex-end;margin-top:8px">
      <button class="submit-btn" onclick="goToReflection()">Continue to Reflection</button>
    </div>
  </div>

  <!-- STEP 5: REFLECTION -->
  <div id="step-reflection" style="display:none">
    <div class="step-indicator" id="stepIndicator4">
      <div class="step-dot done"></div>
      <div class="step-dot done"></div>
      <div class="step-dot done"></div>
      <div class="step-dot active"></div>
      <span class="step-label">Reflection</span>
    </div>

    <div class="section-title"><span class="dot"></span>Empathy Reflection</div>
    <p style="font-size:.85rem;color:var(--muted);margin-bottom:16px;line-height:1.55">Now that you know what happened, reflect carefully. Historical empathy means understanding why someone acted as they did, given their context, not whether we agree with them today.</p>
    <div class="reflection-grid" id="reflectionGrid"></div>

    <div class="submit-row" style="margin-top:4px">
      <button class="submit-btn" id="submitReflection" onclick="submitReflection()">Complete Reflection</button>
    </div>

    <div class="feedback-panel" id="feedbackPanel">
      <h3>Your Empathy Assessment</h3>
      <div class="score-display">
        <div class="score-circle" id="scoreCircle"></div>
        <div class="score-label">
          <strong id="scoreTitle"></strong>
          <span id="scoreDesc"></span>
        </div>
      </div>
      <div id="feedbackText"></div>
    </div>
  </div>
</main>

<!-- INFO PANEL -->
<div class="info-overlay" id="infoOverlay">
  <div class="info-box">
    <button class="close-btn" onclick="closeInfo()">&times;</button>
    <h2>Understanding Historical Empathy</h2>
    <p>Historical empathy is a core skill for any historian. It does not mean feeling sorry for people in the past (that would be <em>sympathy</em>). Instead, it means making the effort to understand why people made the choices they did, given their circumstances, beliefs, and available information.</p>

    <div class="key-term"><strong>Historical Empathy:</strong> The ability to understand past actions and decisions by reconstructing the context, knowledge, pressures, and worldview of the people involved, without imposing modern values or hindsight.</div>

    <h3>Empathy vs Sympathy</h3>
    <p><strong>Sympathy</strong> says: "I feel sorry for them." It is an emotional reaction. <strong>Empathy</strong> says: "I understand why they did that, even if I disagree." It is an intellectual effort to see the world through someone else's eyes.</p>

    <h3>The Problem of Presentism</h3>
    <div class="key-term"><strong>Presentism:</strong> The mistake of judging historical figures by today's moral standards, values, and knowledge, rather than by those of their own time.</div>
    <p>It is tempting to look at the past and say "they should have known better." But people in the past did not have access to the same information, science, moral frameworks, or cultural norms that we do. Judging them solely by our standards is unfair and, more importantly, it prevents us from truly understanding history.</p>

    <h3>Why Context Matters</h3>
    <p>Every historical decision was shaped by factors we might not immediately consider: religious beliefs, social class expectations, political threats, economic pressures, limited communication, and the simple fact that nobody can see into the future. Understanding these factors is the first step towards genuine historical understanding.</p>

    <h3>How to Use This Tool</h3>
    <p>1. Read the context carefully: what did the figure know and believe at the time?</p>
    <p>2. Make a decision based on that context, not on what you know happened next.</p>
    <p>3. Explain your reasoning: show you understand the pressures involved.</p>
    <p>4. After the reveal, reflect on what was known versus unknown, and whether modern judgement is fair.</p>
    <p>There are no "right" answers here. The quality of your reasoning matters far more than which option you choose.</p>
  </div>
</div>

<script>
const SCENARIOS = [
  {
    id: 'henry',
    icon: '\u{1F451}',
    date: 'England, 1534',
    title: 'Henry VIII and the Break with Rome',
    shortDesc: 'A king desperate for a male heir faces the Pope\'s refusal to annul his marriage.',
    intro: 'It is 1534. You are Henry VIII, King of England. You have been married to Catherine of Aragon for over 20 years, but she has not produced a surviving male heir. You believe a son is essential to secure the Tudor dynasty and prevent civil war. The Pope has refused your request for an annulment. You must decide what to do.',
    context: [
      {
        icon: '\u{1F3F0}',
        title: 'Political Situation',
        text: 'The Tudor dynasty is fragile. Henry\'s father won the throne in battle in 1485. Without a clear male heir, England could face another civil war like the Wars of the Roses. Henry has one daughter, Mary, but no English queen has ever ruled in her own right. Many believe a woman cannot hold the throne.',
        note: 'Henry does not know that his daughter Elizabeth will become one of England\'s greatest monarchs.'
      },
      {
        icon: '\u26EA',
        title: 'Religious Context',
        text: 'The Catholic Church controls spiritual life across Europe. The Pope is God\'s representative on Earth in the eyes of most people. Challenging the Pope is not just political rebellion; many believe it risks eternal damnation. However, reformers like Martin Luther are already questioning papal authority in Germany and elsewhere.',
        note: 'The Protestant Reformation is still in its early stages. Its long-term impact is completely unknown.'
      },
      {
        icon: '\u{1F491}',
        title: 'Personal Pressures',
        text: 'Henry genuinely believes his marriage to Catherine is cursed by God because she was previously married to his brother Arthur. He cites a biblical passage (Leviticus 20:21) as evidence. He is also in love with Anne Boleyn, who has refused to become his mistress and insists on marriage. Henry is 42 and feels time is running out.',
        note: 'Henry\'s belief about the curse was sincerely held by many theologians at the time, not just a convenient excuse.'
      },
      {
        icon: '\u2696\uFE0F',
        title: 'Available Options',
        text: 'Henry can continue to negotiate with the Pope, who is under pressure from Catherine\'s nephew, Emperor Charles V (the most powerful ruler in Europe). He could accept the Pope\'s decision and remain childless (in terms of male heirs). Or he could take the radical step of rejecting papal authority over England entirely.',
        note: 'Rejecting Rome means losing the support of Catholic Europe and risking excommunication.'
      }
    ],
    prompt: 'You are Henry VIII in 1534. Your dynasty\'s survival may depend on producing a male heir. The Pope will not grant your annulment. What do you do?',
    options: [
      {
        label: 'A',
        text: 'Accept the Pope\'s decision. Remain married to Catherine and hope that Mary or a future arrangement will secure the succession. Maintain unity with Catholic Europe.',
        id: 'accept'
      },
      {
        label: 'B',
        text: 'Break with Rome. Declare yourself Supreme Head of the Church of England, grant your own annulment, and marry Anne Boleyn. Risk war with Catholic Europe but take control of your own destiny.',
        id: 'break'
      },
      {
        label: 'C',
        text: 'Continue negotiating with the Pope while secretly preparing a break. Buy time diplomatically while building domestic support for a possible split. Avoid committing fully to either path.',
        id: 'delay'
      }
    ],
    reveal: {
      title: 'Henry chose to break with Rome.',
      text: 'In 1534, the Act of Supremacy declared Henry VIII the Supreme Head of the Church of England. He married Anne Boleyn, who gave birth to a daughter, Elizabeth, not the son Henry desperately wanted. Anne was executed in 1536. Henry went on to marry four more times. He finally had a son, Edward, with his third wife Jane Seymour, but Edward died at 15. Ironically, it was the daughter of the marriage Henry was so desperate to end, Mary, and then Anne Boleyn\'s daughter Elizabeth, who eventually succeeded him.'
    },
    timeline: [
      { date: '1534', text: 'Act of Supremacy passes. Henry becomes Supreme Head of the Church of England.' },
      { date: '1536', text: 'Dissolution of the monasteries begins. Anne Boleyn is executed.' },
      { date: '1537', text: 'Jane Seymour gives birth to Edward VI but dies shortly after.' },
      { date: '1547', text: 'Henry VIII dies. Edward VI becomes king aged 9.' },
      { date: '1553', text: 'Edward dies. Mary I takes the throne and restores Catholicism.' },
      { date: '1558', text: 'Elizabeth I becomes queen and establishes a lasting Protestant settlement.' }
    ],
    reflections: [
      'What pressures was Henry under that made his decision feel urgent and necessary?',
      'What did Henry not know that we know now? How does hindsight change our view of his decision?',
      'Is it fair to judge Henry by today\'s standards of marriage and religious freedom? Why or why not?'
    ]
  },
  {
    id: 'factory',
    icon: '\u{1F3ED}',
    date: 'Manchester, 1833',
    title: 'The Factory Owner\'s Dilemma',
    shortDesc: 'A mill owner must decide whether to employ children as new regulations loom.',
    intro: 'It is 1833. You are the owner of a cotton mill in Manchester. You currently employ children as young as eight, which is normal practice across the industry. Parliament is debating the Factory Act, which would restrict child labour. You must decide how to respond.',
    context: [
      {
        icon: '\u{1F4B0}',
        title: 'Economic Reality',
        text: 'Your mill operates on thin margins. Competition from other mills is fierce. Children are paid a fraction of adult wages (around 1-2 shillings per week compared to 10-15 for adults). Their small hands are useful for reaching into machinery. If you stop employing children and your competitors don\'t, you could go bankrupt. Hundreds of adult workers depend on your mill for their livelihoods.',
        note: 'There is no welfare state. If the mill closes, every worker and their family faces destitution.'
      },
      {
        icon: '\u{1F46A}',
        title: 'Social Norms',
        text: 'Child labour is not considered unusual or immoral by most people in 1833. Children have always worked, whether on farms, in domestic service, or in workshops. Many families depend on their children\'s wages to survive. Some parents actively seek factory work for their children. The concept of "childhood" as a protected, carefree period is a luxury that working families cannot afford.',
        note: 'Compulsory schooling does not yet exist. For many poor children, the alternative to the factory is begging or the workhouse.'
      },
      {
        icon: '\u{1F4DC}',
        title: 'The Reformers\' Case',
        text: 'A growing number of reformers, including factory owners like Robert Owen, argue that child labour is harmful. Medical evidence is beginning to show that long hours in mills damage children\'s health and growth. Some religious leaders argue it is unchristian. The proposed Factory Act would limit children aged 9-13 to 8 hours per day and require some schooling.',
        note: 'The reform movement is gaining ground, but many see it as government interference in private business.'
      },
      {
        icon: '\u{1F9ED}',
        title: 'Your Beliefs',
        text: 'You consider yourself a decent man. You provide employment for over 200 people. You have seen children injured by machinery and it troubles you, but you tell yourself the alternative for most of them would be worse. You attend church every Sunday. You provide basic meals for your child workers. Some of your fellow mill owners are far less generous.',
        note: 'You genuinely believe you are doing more good than harm by providing employment.'
      }
    ],
    prompt: 'You are a Manchester mill owner in 1833. The Factory Act is being debated. Child labour is standard practice and your business depends on it. What do you do?',
    options: [
      {
        label: 'A',
        text: 'Continue employing children as before. Resist the Factory Act as unnecessary interference. Argue that you already treat your workers fairly and that regulation will destroy jobs and harm the very children it claims to protect.',
        id: 'resist'
      },
      {
        label: 'B',
        text: 'Comply with the proposed Act but do the minimum required. Limit children\'s hours as the law demands, but replace them with slightly older children or find other ways to keep costs down. Protect your business while staying within the law.',
        id: 'comply'
      },
      {
        label: 'C',
        text: 'Go further than the law requires. Stop employing children under 12 entirely, improve conditions, and invest in machinery that reduces the need for child labour. Accept lower profits and hope that the industry will eventually follow your example.',
        id: 'reform'
      }
    ],
    reveal: {
      title: 'The Factory Act of 1833 was passed.',
      text: 'The 1833 Factory Act banned employment of children under 9 in textile factories and limited hours for older children. However, enforcement was extremely weak, with only four inspectors for the entire country. Many factory owners found ways around the Act. Genuine change came slowly, through decades of further legislation, the growth of compulsory education, and improvements in technology that made child labour less economically necessary. Most factory owners of the era chose something between compliance and quiet evasion.'
    },
    timeline: [
      { date: '1833', text: 'Factory Act passes. Children under 9 banned from textile factories. Only 4 inspectors appointed.' },
      { date: '1844', text: 'Further Factory Act reduces children\'s working hours to 6.5 per day.' },
      { date: '1847', text: 'Ten Hours Act limits women and children to a 10-hour working day.' },
      { date: '1870', text: 'Education Act establishes the principle of schooling for all children.' },
      { date: '1880', text: 'Education becomes compulsory for children aged 5-10.' },
      { date: '1901', text: 'Minimum working age raised to 12. Child labour in factories effectively ends.' }
    ],
    reflections: [
      'What economic and social pressures made child labour seem normal and even necessary in 1833?',
      'What did factory owners not know about child development, health, and education that we understand today?',
      'Is it fair to call these factory owners "evil"? Or were they operating within a system that made their choices seem rational?'
    ]
  },
  {
    id: 'chamberlain',
    icon: '\u{1F4DC}',
    date: 'Munich, 1938',
    title: 'Chamberlain at Munich',
    shortDesc: 'The British PM must decide: appease Hitler\'s demand for the Sudetenland, or risk war.',
    intro: 'It is September 1938. You are Neville Chamberlain, Prime Minister of Britain. Adolf Hitler is demanding that Czechoslovakia hand over the Sudetenland, a region with a large German-speaking population. Hitler threatens war if his demands are not met. You must decide how to respond.',
    context: [
      {
        icon: '\u{1F3D7}\uFE0F',
        title: 'The Shadow of 1914-1918',
        text: 'The First World War ended just 20 years ago. It killed around 17 million people across Europe. Britain lost nearly a million men. Almost every family was touched by loss. The war was supposed to be "the war to end all wars," and the public is overwhelmingly opposed to another conflict. Veterans are still alive, many still bearing physical and psychological scars.',
        note: 'Chamberlain lost a cousin in WW1 and was deeply affected. His horror of war was personal, not abstract.'
      },
      {
        icon: '\u{1F6E1}\uFE0F',
        title: 'Military Reality',
        text: 'Britain\'s military is not ready for war. Rearmament has only recently begun and the RAF lacks sufficient modern aircraft. The British Empire is overstretched, with commitments in Asia, the Middle East, and Africa. France, the main ally, is politically divided and militarily cautious. The Soviet Union is unpredictable and ideologically hostile. The United States is firmly isolationist.',
        note: 'Britain\'s military chiefs have privately warned Chamberlain that the armed forces are not prepared for a major European war.'
      },
      {
        icon: '\u{1F30D}',
        title: 'The Sudetenland Question',
        text: 'Hitler\'s demand has some basis in the principle of national self-determination, the same principle that shaped the post-WW1 treaties. The Sudetenland does have a majority German-speaking population. Many in Britain feel that the Treaty of Versailles was too harsh on Germany and that some revision is justified. Czechoslovakia, while democratic, is a relatively new state that many in Britain know little about.',
        note: 'Nobody yet knows that Hitler\'s ambitions extend far beyond the Sudetenland. His plans for wider conquest are not public.'
      },
      {
        icon: '\u{1F5F3}\uFE0F',
        title: 'Domestic Opinion',
        text: 'The British public overwhelmingly supports finding a peaceful solution. Newspapers, with few exceptions, back negotiations. The King, George VI, supports Chamberlain\'s diplomatic approach. The Labour opposition, while critical of Chamberlain, is also opposed to war. Only a small group, led by Winston Churchill, argues that Hitler cannot be trusted and must be confronted.',
        note: 'Churchill is widely seen as a warmonger and a political has-been in 1938. His warnings are largely dismissed.'
      }
    ],
    prompt: 'You are Neville Chamberlain in September 1938. Hitler demands the Sudetenland. Your military is unready, your public dreads war, and the memory of 1914-18 haunts everyone. What do you do?',
    options: [
      {
        label: 'A',
        text: 'Negotiate with Hitler at Munich. Accept the transfer of the Sudetenland to Germany in exchange for a guarantee of peace. Buy time for rearmament while hoping diplomacy can prevent a wider conflict. Trust that Hitler\'s demands are limited.',
        id: 'appease'
      },
      {
        label: 'B',
        text: 'Refuse Hitler\'s demands. Warn that Britain and France will support Czechoslovakia militarily if Germany attacks. Risk a war that your military chiefs say you are not prepared to fight, in the hope that a firm stand will make Hitler back down.',
        id: 'confront'
      },
      {
        label: 'C',
        text: 'Propose an international conference including the Soviet Union and the United States, insisting on Czechoslovakia\'s right to be represented. Delay any agreement until broader support can be built, even at the risk of Hitler losing patience.',
        id: 'conference'
      }
    ],
    reveal: {
      title: 'Chamberlain chose appeasement at Munich.',
      text: 'On 30 September 1938, Chamberlain, along with French PM Daladier, signed the Munich Agreement, allowing Germany to annex the Sudetenland. Czechoslovakia was not consulted. Chamberlain returned to Britain and famously declared "peace for our time." He was greeted as a hero by cheering crowds. Less than six months later, in March 1939, Hitler invaded the rest of Czechoslovakia, proving that his promises were worthless. Britain declared war on Germany in September 1939 after the invasion of Poland. Chamberlain resigned in May 1940 and died later that year.'
    },
    timeline: [
      { date: 'Sep 1938', text: 'Munich Agreement signed. Chamberlain returns to cheering crowds.' },
      { date: 'Mar 1939', text: 'Hitler invades the rest of Czechoslovakia. Munich Agreement shown to be worthless.' },
      { date: 'Sep 1939', text: 'Germany invades Poland. Britain declares war.' },
      { date: 'May 1940', text: 'Chamberlain resigns. Churchill becomes Prime Minister.' },
      { date: 'Nov 1940', text: 'Chamberlain dies of cancer, his reputation destroyed.' },
      { date: '1945', text: 'War ends after 6 years. Over 60 million dead worldwide.' }
    ],
    reflections: [
      'What pressures and fears made appeasement seem like the responsible choice in 1938?',
      'What did Chamberlain not know about Hitler\'s true intentions that we know now with hindsight?',
      'Is it fair to call Chamberlain a coward or a fool? What would you have done with only the information available in 1938?'
    ]
  },
  {
    id: 'parks',
    icon: '\u{1F68C}',
    date: 'Montgomery, Alabama, 1955',
    title: 'Rosa Parks and the Bus Seat',
    shortDesc: 'A Black woman must decide whether to give up her seat on a segregated bus.',
    intro: 'It is 1 December 1955. You are Rosa Parks, a 42-year-old seamstress and secretary of the local NAACP chapter in Montgomery, Alabama. You are sitting in the first row of the "coloured section" of a city bus. The bus fills up, and the driver orders you and three other Black passengers to give up your seats for a white man. The other three move. You must decide what to do.',
    context: [
      {
        icon: '\u{1F6A8}',
        title: 'The Danger',
        text: 'Defying a bus driver\'s order is illegal under Montgomery\'s segregation laws. You will be arrested. But the risks go far beyond arrest. The American South in 1955 is a place where Black people who challenge white authority can face extreme violence. Emmett Till, a 14-year-old boy, was murdered in Mississippi just three months ago for allegedly speaking disrespectfully to a white woman. His killers were acquitted by an all-white jury.',
        note: 'Between 1877 and 1950, over 4,000 Black Americans were lynched in the South. The threat of violence is constant and real.'
      },
      {
        icon: '\u2696\uFE0F',
        title: 'Legal Reality',
        text: 'Segregation is the law in Alabama and across the South. The Supreme Court ruled in Brown v. Board of Education (1954) that school segregation is unconstitutional, but this has provoked massive resistance. Southern states are actively defying the ruling. Bus segregation has not been struck down. The legal path to change is uncertain, slow, and bitterly contested.',
        note: 'Federal enforcement of desegregation is weak. Southern politicians have signed a "Southern Manifesto" pledging to resist.'
      },
      {
        icon: '\u270A',
        title: 'The Movement',
        text: 'The NAACP and other civil rights organisations have been looking for the right test case to challenge bus segregation in Montgomery. An earlier incident involving Claudette Colvin (a 15-year-old arrested for the same offence in March 1955) was considered, but organisers felt Colvin\'s personal circumstances made her a less ideal public figure. Parks is well-known, respected, and deeply committed to the cause.',
        note: 'Parks is not acting impulsively. She is an experienced activist who has attended training at the Highlander Folk School.'
      },
      {
        icon: '\u{1F46A}',
        title: 'Personal Stakes',
        text: 'You have a husband, Raymond, and an elderly mother who depend on you. If you are arrested, you could lose your job. Your family could face threats and harassment. Raymond is already anxious about the dangers of your NAACP work. You are tired: not just physically, but tired of the daily humiliation of segregation, of stepping off pavements for white people, of drinking from separate fountains, of being treated as less than human.',
        note: 'Parks later said: "People always say that I didn\'t give up my seat because I was tired, but that isn\'t true. I was not tired physically. No, the only tired I was, was tired of giving in."'
      }
    ],
    prompt: 'You are Rosa Parks on 1 December 1955. The bus driver has ordered you to give up your seat. Three other passengers have already moved. You know the risks. What do you do?',
    options: [
      {
        label: 'A',
        text: 'Give up your seat. Live to fight another day. The risks are too great for you and your family. Continue working with the NAACP to find another way to challenge segregation when the time is right.',
        id: 'comply'
      },
      {
        label: 'B',
        text: 'Refuse to move. Stay in your seat quietly and calmly. Accept that you will be arrested, but trust that the NAACP and the community will rally behind you. This could be the moment the movement has been waiting for.',
        id: 'refuse'
      },
      {
        label: 'C',
        text: 'Refuse to move, but try to avoid arrest by arguing your legal right to the seat (you are in the "coloured section," not the "white section"). Challenge the driver\'s interpretation of the law rather than the law itself.',
        id: 'argue'
      }
    ],
    reveal: {
      title: 'Rosa Parks refused to move.',
      text: 'Parks remained in her seat calmly and was arrested. She was bailed out that evening. The following day, the Montgomery Bus Boycott began, organised by a young minister named Dr Martin Luther King Jr., along with other community leaders. Black residents of Montgomery (who made up 75% of bus riders) refused to ride the buses for 381 days. The boycott caused severe financial damage to the bus company and drew national attention. In November 1956, the Supreme Court ruled that bus segregation was unconstitutional. The boycott ended in December 1956 with the buses desegregated. Parks\'s act became one of the defining moments of the American civil rights movement.'
    },
    timeline: [
      { date: '1 Dec 1955', text: 'Rosa Parks arrested for refusing to give up her bus seat.' },
      { date: '5 Dec 1955', text: 'Montgomery Bus Boycott begins. 40,000 Black commuters find other transport.' },
      { date: 'Jan 1956', text: 'King\'s house is bombed. Threats and violence escalate against boycotters.' },
      { date: 'Jun 1956', text: 'Federal court rules bus segregation unconstitutional (Browder v. Gayle).' },
      { date: 'Nov 1956', text: 'Supreme Court upholds the ruling. Montgomery must desegregate buses.' },
      { date: '20 Dec 1956', text: 'Boycott ends after 381 days. Buses are desegregated.' }
    ],
    reflections: [
      'What personal risks and pressures was Rosa Parks facing when she made her decision?',
      'Parks was not acting on impulse; she was a trained activist. Does knowing this change how we understand her courage? Why or why not?',
      'Many people before Parks also refused to comply with segregation but are less well known. What does this tell us about how history remembers individuals versus movements?'
    ]
  }
];

let currentScenario = null;
let chosenOption = null;

function renderScenarioGrid() {
  const grid = document.getElementById('scenarioGrid');
  grid.innerHTML = SCENARIOS.map(s => `
    <div class="scenario-card" data-id="${s.id}" onclick="selectScenario('${s.id}')">
      <div class="sc-icon">${s.icon}</div>
      <div class="sc-date">${s.date}</div>
      <div class="sc-title">${s.title}</div>
      <div class="sc-desc">${s.shortDesc}</div>
    </div>
  `).join('');
}

function selectScenario(id) {
  currentScenario = SCENARIOS.find(s => s.id === id);
  chosenOption = null;

  document.querySelectorAll('.scenario-card').forEach(c => c.classList.remove('selected'));
  document.querySelector(`.scenario-card[data-id="${id}"]`).classList.add('selected');

  renderContext();
  showStep('step-context');
  document.getElementById('resetBtn').style.display = '';
  window.scrollTo({top: 0, behavior: 'smooth'});
}

function renderContext() {
  const s = currentScenario;
  document.getElementById('contextTitle').textContent = s.title + ' : Context';
  document.getElementById('contextIntro').textContent = s.intro;

  const grid = document.getElementById('contextGrid');
  grid.innerHTML = s.context.map(c => `
    <div class="context-card">
      <h3><span class="ctx-icon">${c.icon}</span> ${c.title}</h3>
      <p>${c.text}</p>
      ${c.note ? `<div class="note">${c.note}</div>` : ''}
    </div>
  `).join('');
}

function goToDecision() {
  renderDecision();
  showStep('step-decision');
  window.scrollTo({top: 0, behavior: 'smooth'});
}

function renderDecision() {
  const s = currentScenario;
  document.getElementById('decisionPrompt').textContent = s.prompt;

  const list = document.getElementById('optionList');
  list.innerHTML = s.options.map(o => `
    <button class="option-btn" data-opt="${o.id}" onclick="chooseOption('${o.id}')">
      <span class="opt-label">Option ${o.label}:</span>${o.text}
    </button>
  `).join('');

  document.getElementById('reasoningText').value = '';
  document.getElementById('submitDecision').disabled = true;
  chosenOption = null;
}

function chooseOption(id) {
  chosenOption = id;
  document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('chosen'));
  document.querySelector(`.option-btn[data-opt="${id}"]`).classList.add('chosen');
  checkDecisionReady();
}

function checkDecisionReady() {
  const hasText = document.getElementById('reasoningText').value.trim().length >= 20;
  document.getElementById('submitDecision').disabled = !(chosenOption && hasText);
}

document.addEventListener('input', function(e) {
  if (e.target.id === 'reasoningText') checkDecisionReady();
});

function submitDecision() {
  renderReveal();
  showStep('step-reveal');
  window.scrollTo({top: 0, behavior: 'smooth'});
}

function renderReveal() {
  const s = currentScenario;
  document.getElementById('revealTitle').textContent = s.reveal.title;
  document.getElementById('revealText').textContent = s.reveal.text;

  const tl = document.getElementById('timeline');
  tl.innerHTML = s.timeline.map(t => `
    <div class="timeline-item">
      <div class="tl-date">${t.date}</div>
      <div class="tl-text">${t.text}</div>
    </div>
  `).join('');
}

function goToReflection() {
  renderReflection();
  showStep('step-reflection');
  window.scrollTo({top: 0, behavior: 'smooth'});
}

function renderReflection() {
  const s = currentScenario;
  const grid = document.getElementById('reflectionGrid');
  grid.innerHTML = s.reflections.map((q, i) => `
    <div class="reflection-card">
      <div class="ref-question">${q}</div>
      <textarea class="ref-answer" id="ref-${i}" placeholder="Write your reflection here (at least one sentence)..."></textarea>
    </div>
  `).join('');

  document.getElementById('feedbackPanel').classList.remove('visible');
}

function submitReflection() {
  const answers = [];
  document.querySelectorAll('.ref-answer').forEach(ta => answers.push(ta.value.trim()));

  if (answers.some(a => a.length < 10)) {
    alert('Please write a thoughtful response to each reflection question (at least one sentence each).');
    return;
  }

  const reasoning = document.getElementById('reasoningText').value.trim();
  const score = calculateScore(reasoning, answers);
  showFeedback(score, reasoning, answers);
}

function calculateScore(reasoning, answers) {
  let total = 0;
  const allText = [reasoning, ...answers].join(' ').toLowerCase();

  // Length and effort
  const wordCount = allText.split(/\s+/).length;
  if (wordCount > 50) total += 1;
  if (wordCount > 100) total += 1;
  if (wordCount > 180) total += 1;

  // Context awareness keywords
  const contextWords = ['pressure', 'believed', 'thought', 'feared', 'knew', 'didn\'t know',
    'at the time', 'context', 'situation', 'circumstances', 'expected', 'normal',
    'society', 'culture', 'belief', 'information', 'limited', 'perspective',
    'understand', 'position', 'difficult', 'choice', 'dilemma'];
  const contextHits = contextWords.filter(w => allText.includes(w)).length;
  total += Math.min(contextHits, 4);

  // Empathy indicators
  const empathyWords = ['empathy', 'empathise', 'their shoes', 'point of view', 'perspective',
    'understand why', 'from their', 'they believed', 'they thought', 'they felt',
    'in their position', 'facing', 'weighing'];
  const empathyHits = empathyWords.filter(w => allText.includes(w)).length;
  total += Math.min(empathyHits, 3);

  // Hindsight awareness
  const hindsightWords = ['hindsight', 'we know now', 'looking back', 'today we',
    'they couldn\'t know', 'couldn\'t have known', 'didn\'t know',
    'with the benefit', 'modern', 'our standards', 'presentism', 'unfair to judge'];
  const hindsightHits = hindsightWords.filter(w => allText.includes(w)).length;
  total += Math.min(hindsightHits, 3);

  // Nuance and complexity
  const nuanceWords = ['however', 'although', 'on the other hand', 'but also',
    'complicated', 'complex', 'not simple', 'both', 'while', 'nevertheless',
    'that said', 'at the same time', 'balanced'];
  const nuanceHits = nuanceWords.filter(w => allText.includes(w)).length;
  total += Math.min(nuanceHits, 3);

  // Cap at 14, scale to 5 tiers
  return Math.min(total, 14);
}

function showFeedback(score, reasoning, answers) {
  const panel = document.getElementById('feedbackPanel');

  let tier, title, desc;
  if (score >= 11) {
    tier = 5; title = 'Exceptional Empathy';
    desc = 'You demonstrated outstanding historical empathy. Your responses showed deep awareness of context, genuine effort to understand the figure\'s perspective, and mature reflection on the limits of hindsight.';
  } else if (score >= 8) {
    tier = 4; title = 'Strong Empathy';
    desc = 'You showed strong historical empathy. You engaged seriously with the context and made a clear effort to understand the pressures involved. Consider whether you could dig even deeper into what the figure did not know.';
  } else if (score >= 5) {
    tier = 3; title = 'Developing Empathy';
    desc = 'You are developing good historical empathy skills. You showed some awareness of context, but try to push further. Ask yourself: what was "normal" in their world? What information did they lack? What fears drove them?';
  } else if (score >= 3) {
    tier = 2; title = 'Emerging Empathy';
    desc = 'You are beginning to engage with historical empathy. Try to move beyond right and wrong, and focus more on understanding the specific pressures, beliefs, and limitations of the time. Avoid judging by today\'s standards without acknowledging the differences.';
  } else {
    tier = 1; title = 'Keep Developing';
    desc = 'Historical empathy takes practice. Try to write more detailed responses that specifically address what the figure knew, feared, and believed. The goal is not to agree with their decision, but to understand why it made sense to them.';
  }

  document.getElementById('scoreCircle').textContent = tier + '/5';
  document.getElementById('scoreTitle').textContent = title;
  document.getElementById('scoreDesc').textContent = 'Thoughtfulness of reasoning and reflection';

  let feedback = `<p>${desc}</p>`;
  feedback += '<p style="margin-top:12px;color:var(--gold-light);font-weight:600;font-size:.85rem">Remember:</p>';
  feedback += '<p style="font-size:.82rem">Historical empathy is not about excusing harmful actions. It is about understanding the human beings behind historical events, recognising the constraints they operated under, and resisting the temptation to assume we would automatically have done better in their place.</p>';

  document.getElementById('feedbackText').innerHTML = feedback;
  panel.classList.add('visible');
  panel.scrollIntoView({behavior: 'smooth', block: 'center'});
}

function showStep(stepId) {
  ['step-select','step-context','step-decision','step-reveal','step-reflection'].forEach(id => {
    document.getElementById(id).style.display = id === stepId || id === 'step-select' ? '' : 'none';
  });
  // Always keep selector visible but dim when not active
  if (stepId !== 'step-select') {
    document.getElementById('step-select').style.display = 'none';
  }
}

function resetAll() {
  currentScenario = null;
  chosenOption = null;
  document.querySelectorAll('.scenario-card').forEach(c => c.classList.remove('selected'));
  document.getElementById('resetBtn').style.display = 'none';
  ['step-context','step-decision','step-reveal','step-reflection'].forEach(id => {
    document.getElementById(id).style.display = 'none';
  });
  document.getElementById('step-select').style.display = '';
  window.scrollTo({top: 0, behavior: 'smooth'});
}

function openInfo() {
  document.getElementById('infoOverlay').classList.add('open');
}
function closeInfo() {
  document.getElementById('infoOverlay').classList.remove('open');
}
document.getElementById('infoOverlay').addEventListener('click', function(e) {
  if (e.target === this) closeInfo();
});
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') closeInfo();
});

// Init
renderScenarioGrid();
</script>
</body>
</html>
