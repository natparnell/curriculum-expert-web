<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interpretations Comparator</title>
<style>
:root {
  --bg-primary: #faf8f5;
  --bg-white: #ffffff;
  --bg-cream: #f5f0e8;
  --text-dark: #2c2c2c;
  --text-mid: #555555;
  --text-light: #777777;
  --teal: #1a7a6d;
  --teal-light: #e0f2ef;
  --teal-dark: #145f54;
  --burgundy: #8b2252;
  --burgundy-light: #f5e0ea;
  --burgundy-dark: #6e1a41;
  --agree-green: #2d8a4e;
  --agree-bg: #e6f5ec;
  --disagree-red: #c0392b;
  --disagree-bg: #fde8e6;
  --claim-color: #2980b9;
  --evidence-color: #27ae60;
  --judgement-color: #e67e22;
  --opinion-color: #9b59b6;
  --border: #d5d0c8;
  --shadow: rgba(0,0,0,0.08);
  --radius: 8px;
  --font-main: Georgia, 'Times New Roman', serif;
  --font-ui: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: var(--font-main);
  background: var(--bg-primary);
  color: var(--text-dark);
  line-height: 1.6;
  min-height: 100vh;
}
header {
  position: sticky; top: 0; z-index: 100;
  background: linear-gradient(135deg, var(--teal-dark), var(--burgundy-dark));
  color: #fff; padding: 16px 24px;
  box-shadow: 0 2px 8px var(--shadow);
}
header h1 { font-size: 1.5rem; font-weight: 700; letter-spacing: 0.5px; }
header p { font-family: var(--font-ui); font-size: 0.85rem; opacity: 0.85; margin-top: 2px; }
.container { max-width: 1280px; margin: 0 auto; padding: 20px; }

/* Topic Selector */
.topic-selector {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 12px; margin-bottom: 24px;
}
.topic-btn {
  font-family: var(--font-ui); font-size: 0.88rem;
  padding: 14px 16px; border: 2px solid var(--border);
  background: var(--bg-white); border-radius: var(--radius);
  cursor: pointer; text-align: left; transition: all 0.2s;
  line-height: 1.4;
}
.topic-btn:hover { border-color: var(--teal); background: var(--teal-light); }
.topic-btn.active { border-color: var(--teal); background: var(--teal-light); font-weight: 600; }
.topic-btn .topic-label { font-weight: 600; display: block; margin-bottom: 4px; color: var(--teal-dark); }
.topic-btn .topic-desc { font-size: 0.8rem; color: var(--text-mid); }

/* Section headings */
.section-title {
  font-family: var(--font-ui); font-size: 1.1rem; font-weight: 700;
  margin: 28px 0 14px; padding-bottom: 8px;
  border-bottom: 2px solid var(--border); color: var(--text-dark);
}

/* Tag legend */
.tag-legend {
  display: flex; flex-wrap: wrap; gap: 10px;
  margin-bottom: 16px; font-family: var(--font-ui); font-size: 0.8rem;
}
.tag-legend span {
  padding: 3px 10px; border-radius: 12px; font-weight: 600;
}
.tag-claim { background: #d4e6f1; color: var(--claim-color); }
.tag-evidence { background: #d5f5e3; color: var(--evidence-color); }
.tag-judgement { background: #fdebd0; color: var(--judgement-color); }
.tag-opinion { background: #e8daef; color: var(--opinion-color); }

/* Annotation toolbar */
.annotation-toolbar {
  display: flex; flex-wrap: wrap; gap: 8px; align-items: center;
  margin-bottom: 16px; font-family: var(--font-ui);
}
.annotation-toolbar label { font-size: 0.85rem; font-weight: 600; margin-right: 4px; }
.anno-btn {
  font-family: var(--font-ui); font-size: 0.78rem; font-weight: 600;
  padding: 5px 12px; border: 2px solid transparent; border-radius: 14px;
  cursor: pointer; transition: all 0.15s;
}
.anno-btn[data-tag="claim"] { background: #d4e6f1; color: var(--claim-color); border-color: var(--claim-color); }
.anno-btn[data-tag="evidence"] { background: #d5f5e3; color: var(--evidence-color); border-color: var(--evidence-color); }
.anno-btn[data-tag="judgement"] { background: #fdebd0; color: var(--judgement-color); border-color: var(--judgement-color); }
.anno-btn[data-tag="opinion"] { background: #e8daef; color: var(--opinion-color); border-color: var(--opinion-color); }
.anno-btn.active { color: #fff; }
.anno-btn[data-tag="claim"].active { background: var(--claim-color); }
.anno-btn[data-tag="evidence"].active { background: var(--evidence-color); }
.anno-btn[data-tag="judgement"].active { background: var(--judgement-color); }
.anno-btn[data-tag="opinion"].active { background: var(--opinion-color); }
.anno-clear {
  font-family: var(--font-ui); font-size: 0.78rem;
  padding: 5px 12px; border: 1px solid var(--border); border-radius: 14px;
  background: var(--bg-white); cursor: pointer; color: var(--text-mid);
}
.anno-clear:hover { background: var(--disagree-bg); color: var(--disagree-red); }

/* Comparison panels */
.comparison-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
.interp-panel {
  background: var(--bg-white); border-radius: var(--radius);
  border: 2px solid var(--border); overflow: hidden;
  box-shadow: 0 1px 4px var(--shadow);
}
.interp-panel.panel-a { border-top: 4px solid var(--teal); }
.interp-panel.panel-b { border-top: 4px solid var(--burgundy); }
.panel-header {
  padding: 14px 18px; font-family: var(--font-ui);
}
.panel-a .panel-header { background: var(--teal-light); }
.panel-b .panel-header { background: var(--burgundy-light); }
.panel-header h3 { font-size: 1rem; margin-bottom: 2px; }
.panel-a .panel-header h3 { color: var(--teal-dark); }
.panel-b .panel-header h3 { color: var(--burgundy-dark); }
.panel-header .historian-desc { font-size: 0.8rem; color: var(--text-mid); }
.panel-body { padding: 18px; }
.panel-body .sentence {
  display: inline; cursor: pointer; padding: 1px 2px;
  border-radius: 3px; transition: background 0.15s;
  position: relative;
}
.panel-body .sentence:hover { background: #eee; }
.panel-body .sentence.tagged-claim { background: #d4e6f1; }
.panel-body .sentence.tagged-evidence { background: #d5f5e3; }
.panel-body .sentence.tagged-judgement { background: #fdebd0; }
.panel-body .sentence.tagged-opinion { background: #e8daef; }
.panel-body .sentence.agree-highlight { outline: 2px solid var(--agree-green); outline-offset: 1px; }
.panel-body .sentence.disagree-highlight { outline: 2px solid var(--disagree-red); outline-offset: 1px; }
.sentence .tag-badge {
  font-family: var(--font-ui); font-size: 0.6rem; font-weight: 700;
  text-transform: uppercase; vertical-align: super; margin-left: 2px;
}

/* Agree/Disagree toolbar */
.highlight-toolbar {
  display: flex; flex-wrap: wrap; gap: 8px; align-items: center;
  margin-bottom: 16px; font-family: var(--font-ui);
}
.hl-btn {
  font-family: var(--font-ui); font-size: 0.78rem; font-weight: 600;
  padding: 5px 12px; border: 2px solid; border-radius: 14px; cursor: pointer;
}
.hl-btn.agree { background: var(--agree-bg); color: var(--agree-green); border-color: var(--agree-green); }
.hl-btn.disagree { background: var(--disagree-bg); color: var(--disagree-red); border-color: var(--disagree-red); }
.hl-btn.agree.active { background: var(--agree-green); color: #fff; }
.hl-btn.disagree.active { background: var(--disagree-red); color: #fff; }

/* Analysis section */
.analysis-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
.analysis-card {
  background: var(--bg-white); border-radius: var(--radius);
  border: 1px solid var(--border); padding: 20px;
  box-shadow: 0 1px 4px var(--shadow);
}
.analysis-card h4 { font-family: var(--font-ui); font-size: 0.95rem; margin-bottom: 14px; color: var(--text-dark); }
canvas#vennCanvas { width: 100%; max-height: 280px; display: block; margin: 0 auto; }

/* Evidence meters */
.meter-group { margin-bottom: 14px; }
.meter-label { font-family: var(--font-ui); font-size: 0.82rem; font-weight: 600; margin-bottom: 6px; }
.meter-label.label-a { color: var(--teal-dark); }
.meter-label.label-b { color: var(--burgundy-dark); }
.meter-bar-track {
  height: 22px; background: #eee; border-radius: 11px; overflow: hidden; position: relative;
}
.meter-bar-fill {
  height: 100%; border-radius: 11px; transition: width 0.4s ease;
  display: flex; align-items: center; justify-content: flex-end;
  padding-right: 8px; font-family: var(--font-ui); font-size: 0.7rem;
  font-weight: 700; color: #fff;
}
.meter-bar-fill.fill-a { background: var(--teal); }
.meter-bar-fill.fill-b { background: var(--burgundy); }
.meter-controls {
  display: flex; gap: 6px; margin-top: 6px; font-family: var(--font-ui);
}
.meter-controls button {
  font-family: var(--font-ui); font-size: 0.75rem;
  padding: 3px 10px; border: 1px solid var(--border); border-radius: 10px;
  background: var(--bg-white); cursor: pointer;
}
.meter-controls button:hover { background: var(--bg-cream); }

/* Justification */
.justify-area {
  width: 100%; min-height: 100px; padding: 12px;
  font-family: var(--font-main); font-size: 0.9rem;
  border: 1px solid var(--border); border-radius: var(--radius);
  resize: vertical; line-height: 1.5;
}
.justify-area:focus { outline: 2px solid var(--teal); border-color: var(--teal); }
.justify-prompt {
  font-family: var(--font-ui); font-size: 0.82rem; color: var(--text-mid);
  margin-bottom: 8px; font-style: italic;
}

/* Key Questions */
.questions-panel {
  background: var(--bg-cream); border-radius: var(--radius);
  padding: 20px; margin-bottom: 24px; border: 1px solid var(--border);
}
.question-item {
  font-family: var(--font-ui); font-size: 0.88rem;
  padding: 10px 14px; margin-bottom: 8px;
  background: var(--bg-white); border-radius: var(--radius);
  border-left: 4px solid var(--teal); cursor: pointer;
  transition: all 0.15s;
}
.question-item:hover { border-left-color: var(--burgundy); transform: translateX(4px); }
.question-item:last-child { margin-bottom: 0; }

/* Info panel */
.info-panel {
  background: var(--bg-white); border-radius: var(--radius);
  border: 1px solid var(--border); padding: 24px;
  margin-bottom: 24px; box-shadow: 0 1px 4px var(--shadow);
}
.info-panel h4 { font-family: var(--font-ui); font-size: 1rem; margin-bottom: 10px; color: var(--teal-dark); }
.info-panel p { font-size: 0.9rem; margin-bottom: 10px; color: var(--text-mid); }
.info-panel ul { margin: 8px 0 12px 20px; font-size: 0.88rem; color: var(--text-mid); }
.info-panel li { margin-bottom: 5px; }
.info-toggle {
  font-family: var(--font-ui); font-size: 0.85rem; font-weight: 600;
  padding: 8px 16px; border: 2px solid var(--teal); border-radius: var(--radius);
  background: var(--bg-white); color: var(--teal); cursor: pointer;
  margin-bottom: 24px; transition: all 0.15s;
}
.info-toggle:hover { background: var(--teal); color: #fff; }
.info-toggle.open { background: var(--teal); color: #fff; }
.info-content { display: none; }
.info-content.visible { display: block; }

/* Responsive */
@media (max-width: 860px) {
  .comparison-grid, .analysis-grid { grid-template-columns: 1fr; }
  .topic-selector { grid-template-columns: 1fr; }
  header { padding: 12px 16px; }
  header h1 { font-size: 1.2rem; }
  .container { padding: 14px; }
}
</style>
</head>
<body>

<header>
  <h1>Interpretations Comparator</h1>
  <p>Compare how different historians interpret the same event. Analyse agreements, disagreements, and the evidence each uses.</p>
</header>

<div class="container">

  <h2 class="section-title">Choose a Historical Debate</h2>
  <div class="topic-selector" id="topicSelector"></div>

  <div id="mainContent" style="display:none;">

    <h2 class="section-title">Annotation Tools</h2>
    <div class="tag-legend">
      <span class="tag-claim">Claim</span>
      <span class="tag-evidence">Evidence</span>
      <span class="tag-judgement">Judgement</span>
      <span class="tag-opinion">Opinion</span>
    </div>
    <div class="annotation-toolbar">
      <label>Tag sentences as:</label>
      <button class="anno-btn" data-tag="claim">Claim</button>
      <button class="anno-btn" data-tag="evidence">Evidence</button>
      <button class="anno-btn" data-tag="judgement">Judgement</button>
      <button class="anno-btn" data-tag="opinion">Opinion</button>
      <button class="anno-clear" onclick="clearAnnotations()">Clear All Tags</button>
    </div>
    <div class="highlight-toolbar">
      <label>Mark agreement/disagreement:</label>
      <button class="hl-btn agree" onclick="toggleHighlightMode('agree')">Agreement</button>
      <button class="hl-btn disagree" onclick="toggleHighlightMode('disagree')">Disagreement</button>
      <button class="anno-clear" onclick="clearHighlights()">Clear Highlights</button>
    </div>

    <h2 class="section-title">Compare Interpretations</h2>
    <div class="comparison-grid" id="comparisonGrid"></div>

    <h2 class="section-title">Analysis Tools</h2>
    <div class="analysis-grid">
      <div class="analysis-card">
        <h4>Venn Diagram: Shared vs Unique Claims</h4>
        <canvas id="vennCanvas" width="500" height="280"></canvas>
        <p style="font-family:var(--font-ui);font-size:0.78rem;color:var(--text-light);margin-top:8px;text-align:center;">
          Tag sentences as "Claim" in both panels to populate the diagram.
        </p>
      </div>
      <div class="analysis-card">
        <h4>Evidence Strength Meter</h4>
        <p style="font-family:var(--font-ui);font-size:0.82rem;color:var(--text-mid);margin-bottom:12px;">
          Rate the strength of evidence each historian provides.
        </p>
        <div class="meter-group">
          <div class="meter-label label-a" id="meterLabelA">Historian A</div>
          <div class="meter-bar-track">
            <div class="meter-bar-fill fill-a" id="meterFillA" style="width:50%;">5/10</div>
          </div>
          <div class="meter-controls">
            <button onclick="adjustMeter('A',-1)">- Weaker</button>
            <button onclick="adjustMeter('A',1)">+ Stronger</button>
          </div>
        </div>
        <div class="meter-group">
          <div class="meter-label label-b" id="meterLabelB">Historian B</div>
          <div class="meter-bar-track">
            <div class="meter-bar-fill fill-b" id="meterFillB" style="width:50%;">5/10</div>
          </div>
          <div class="meter-controls">
            <button onclick="adjustMeter('B',-1)">- Weaker</button>
            <button onclick="adjustMeter('B',1)">+ Stronger</button>
          </div>
        </div>
      </div>
    </div>

    <div class="analysis-card" style="margin-bottom:24px;">
      <h4>Whose Interpretation Is More Convincing?</h4>
      <div class="justify-prompt">Consider: What evidence do they use? How well do they support their claims? What perspectives might they be missing?</div>
      <textarea class="justify-area" id="justifyArea" placeholder="Write your evaluation here. Explain which historian's interpretation you find more convincing and why, referencing specific evidence and reasoning from both texts..."></textarea>
    </div>

    <h2 class="section-title">Key Questions for Analysis</h2>
    <div class="questions-panel" id="questionsPanel"></div>

    <button class="info-toggle" id="infoToggle" onclick="toggleInfo()">About Evaluating Historical Interpretations</button>
    <div class="info-panel">
      <div class="info-content" id="infoContent">
        <h4>Why Do Historians Disagree?</h4>
        <p>Historians often reach different conclusions about the same events. This is not a flaw; it reflects the nature of historical enquiry. Disagreements arise because:</p>
        <ul>
          <li><strong>Different evidence</strong>: Historians may use different primary sources, or weight the same sources differently.</li>
          <li><strong>Different questions</strong>: The questions a historian asks shape the answers they find. Economic historians ask different questions from political or social historians.</li>
          <li><strong>Different perspectives</strong>: A historian's background, values, and theoretical framework influence their interpretation.</li>
          <li><strong>New discoveries</strong>: As new evidence emerges or previously restricted archives open, interpretations can change.</li>
        </ul>
        <h4>How to Evaluate Interpretations</h4>
        <p>When comparing interpretations, consider these criteria:</p>
        <ul>
          <li><strong>Evidence base</strong>: How much evidence does the historian use? Is it primary or secondary? Is it representative or cherry-picked?</li>
          <li><strong>Logic of argument</strong>: Does the reasoning follow from the evidence? Are there gaps or leaps in logic?</li>
          <li><strong>Scope</strong>: Does the interpretation account for multiple factors, or does it oversimplify a complex situation?</li>
          <li><strong>Bias awareness</strong>: Does the historian acknowledge limitations in their evidence or perspective?</li>
          <li><strong>Historiographical context</strong>: Where does the interpretation sit within the broader debate? Does it respond to earlier scholarship?</li>
        </ul>
        <h4>The Role of Evidence and Perspective</h4>
        <p>Evidence does not "speak for itself." Historians must select, interpret, and arrange evidence into a narrative. Two historians examining the same archive may reach different conclusions because they bring different questions, methods, and assumptions to their work. Understanding this helps us read historical interpretations critically, recognising that all history is, to some degree, an act of interpretation.</p>
      </div>
    </div>

  </div>
</div>

<script>
const TOPICS = [
  {
    id: 'civil-war',
    label: 'The English Civil War',
    desc: 'Was the English Civil War caused by religion or politics? (Whig vs Revisionist)',
    historianA: {
      name: 'The Whig Interpretation',
      desc: 'Long-term constitutional and religious causes',
      sentences: [
        'The English Civil War was the inevitable result of a century-long struggle between the Crown and Parliament over constitutional rights.',
        'Since the reign of Elizabeth I, tensions had been growing between monarchs who claimed divine right and a Parliament that insisted on its ancient liberties.',
        'The conflict was fundamentally about who held sovereignty in England: the King or the representatives of the people.',
        'Religious divisions played a central role, as Puritans in Parliament saw the established Church as insufficiently reformed and too close to Catholicism.',
        'The evidence from parliamentary debates in the 1620s shows a consistent pattern of resistance to royal authority on matters of taxation and religious policy.',
        'Charles I\'s attempt to rule without Parliament for eleven years (the Personal Rule, 1629-1640) demonstrated exactly the kind of tyranny that parliamentarians had long feared.',
        'The Grand Remonstrance of 1641, with its catalogue of royal abuses, proves that Parliament saw itself as defending long-established freedoms.',
        'This was not a sudden breakdown but a structural crisis that had been developing for generations, rooted in deep disagreements about governance and faith.'
      ],
      claims: [0, 2, 7],
      agreements: [3],
      disagreements: [0, 5, 7]
    },
    historianB: {
      name: 'The Revisionist Interpretation',
      desc: 'Short-term political miscalculations and contingency',
      sentences: [
        'The English Civil War was not inevitable; it resulted from a series of short-term political miscalculations and contingent events in the late 1630s and early 1640s.',
        'There was no long-term constitutional conflict building towards war; most people in England, including most MPs, were loyal to the monarchy and the established Church.',
        'The evidence shows that Parliament was not a unified opposition to the Crown but a diverse body with many members who supported Charles I.',
        'The real trigger for war was the crisis in Scotland and Ireland, which forced Charles to recall Parliament and created unprecedented political instability.',
        'Religion mattered, but not in the way Whig historians suggest; the key religious issue was the fear of popery and Arminianism, which was a short-term panic rather than a century-long struggle.',
        'The records of county politics reveal that most of the English gentry wanted compromise and peace, not revolution.',
        'It took specific decisions by specific individuals, particularly Charles I\'s attempt to arrest five MPs in January 1642, to push the country from crisis to armed conflict.',
        'To portray the war as the culmination of an inevitable constitutional struggle is to impose a pattern on events that contemporaries would not have recognised.'
      ],
      claims: [0, 1, 7],
      agreements: [4],
      disagreements: [0, 1, 8]
    },
    questions: [
      'What evidence does the Whig interpretation use to support the idea of a long-term constitutional crisis?',
      'How does the Revisionist historian challenge the idea that war was inevitable?',
      'Both sides mention religion. How do they differ in their assessment of its importance?',
      'What might the Whig historian say in response to the claim that the war was caused by short-term contingencies?',
      'What evidence is missing from both interpretations? Consider social and economic factors.',
      'Which interpretation better accounts for why ordinary people chose sides in the conflict?'
    ]
  },
  {
    id: 'empire',
    label: 'The British Empire',
    desc: 'Was the British Empire a force for good or harm? (Ferguson vs Dirks perspectives)',
    historianA: {
      name: 'The Positive Legacy View (Ferguson)',
      desc: 'Empire spread institutions, trade, and modernity',
      sentences: [
        'The British Empire, for all its faults, was a crucial engine of globalisation that spread free trade, the rule of law, and representative government across the world.',
        'No other political entity in history has done more to promote the free movement of goods, capital, and labour across borders.',
        'The infrastructure built by the Empire, including railways, telegraph systems, ports, and legal frameworks, laid the foundation for economic development in many former colonies.',
        'Statistical evidence shows that countries colonised by Britain have, on average, stronger institutions and higher GDP per capita than those colonised by other European powers.',
        'The abolition of the slave trade in 1807 and slavery itself in 1833 demonstrates that the Empire was capable of profound moral reform from within.',
        'English common law, parliamentary democracy, and the English language are legacies that continue to benefit billions of people.',
        'While violence and exploitation certainly occurred, these must be weighed against the constructive contributions the Empire made to global development.',
        'The alternative to British rule in many regions would not have been independence and prosperity but domination by less liberal imperial powers.'
      ],
      claims: [0, 1, 7],
      agreements: [4],
      disagreements: [0, 2, 7]
    },
    historianB: {
      name: 'The Critical View (Dirks)',
      desc: 'Empire caused exploitation, violence, and lasting harm',
      sentences: [
        'The British Empire was built on systematic exploitation, violence, and racial domination, and its legacy continues to shape global inequality today.',
        'The notion that Empire "spread civilisation" obscures the reality that colonised peoples already had sophisticated cultures, legal systems, and economies before British arrival.',
        'In India alone, British economic policies contributed to repeated famines that killed tens of millions of people, including the Bengal Famine of 1943.',
        'The evidence from colonial archives reveals a consistent pattern of resource extraction designed to benefit Britain at the expense of local populations.',
        'While Britain abolished its own slave trade, it had profited enormously from slavery for over two centuries, and the compensation paid in 1833 went to slave owners, not to enslaved people.',
        'Colonial infrastructure such as railways was built primarily to move resources to ports for export, not to serve the needs of local communities.',
        'The democratic institutions that Britain claims to have exported were systematically denied to colonial subjects, who were ruled by governors with authoritarian powers.',
        'To weigh the "costs and benefits" of empire is to adopt the perspective of the coloniser; for those who were colonised, the experience was overwhelmingly one of dispossession and subjugation.'
      ],
      claims: [0, 7],
      agreements: [4],
      disagreements: [0, 2, 5]
    },
    questions: [
      'What specific evidence does the positive legacy view cite to support its claims about economic development?',
      'How does the critical view challenge the idea that imperial infrastructure benefited colonised peoples?',
      'Both interpretations mention the abolition of slavery. How do they use this same evidence to reach different conclusions?',
      'What might the positive legacy view say in response to the accusation of systematic exploitation?',
      'What evidence is missing from both interpretations? Consider the perspectives of colonised peoples themselves.',
      'Does the framing of "costs and benefits" help or hinder our understanding of empire?'
    ]
  },
  {
    id: 'ww1',
    label: 'Germany and WW1',
    desc: 'Why did Germany lose WW1? (Military vs Economic vs Political interpretations)',
    historianA: {
      name: 'The Military-Economic Interpretation',
      desc: 'Material exhaustion and the naval blockade',
      sentences: [
        'Germany lost the First World War primarily because of material exhaustion: the Allied naval blockade strangled the German economy and starved both the military and civilian population.',
        'By 1918, Germany was producing only 58% of the grain it had produced in 1913, and civilian deaths from malnutrition and disease exceeded 400,000 during the war.',
        'The entry of the United States in 1917 decisively shifted the balance of manpower and resources against Germany, making long-term victory impossible.',
        'The failure of the Spring Offensive in 1918, despite initial tactical success, demonstrated that Germany lacked the reserves and logistical capacity to sustain a breakthrough.',
        'Economic data from the German war economy shows a progressive decline in industrial output, with critical shortages of rubber, copper, and nitrates by 1917.',
        'The Allied adoption of combined-arms tactics, including tanks, aircraft, and coordinated artillery, gave them a decisive tactical advantage by the summer of 1918.',
        'Germany\'s military leadership, particularly Ludendorff, made critical strategic errors, including the unrestricted submarine warfare campaign that brought America into the war.',
        'The collapse was ultimately material: Germany could not match the combined industrial and military resources of the Allied coalition.'
      ],
      claims: [0, 7],
      agreements: [2],
      disagreements: [0, 7]
    },
    historianB: {
      name: 'The Political Interpretation',
      desc: 'Internal divisions and the collapse of the home front',
      sentences: [
        'Germany lost the war not primarily on the battlefield but because of the political collapse of the home front: social divisions, war-weariness, and revolutionary movements fatally undermined the war effort.',
        'The German political system, divided between a militarised autocracy and an increasingly assertive working class, was unable to maintain national unity under the pressures of total war.',
        'The entry of the United States was significant, but its impact was as much psychological as material; it convinced many Germans that the war could not be won.',
        'By 1917, strikes in German munitions factories, the growth of the anti-war movement, and the rise of socialist organisations showed that popular support for the war was collapsing.',
        'The naval mutiny at Kiel in October 1918, which triggered the German Revolution, demonstrates that military discipline depended on political legitimacy that had evaporated.',
        'War-weariness was not unique to Germany, but the German political system was uniquely ill-equipped to manage dissent because it lacked genuine parliamentary accountability.',
        'The "stab-in-the-back" myth that emerged after the war, blaming civilian politicians for the defeat, was a distortion; the political crisis was itself a consequence of the leadership\'s failures.',
        'To focus solely on material factors is to miss the fundamental point: wars are fought by societies, not just armies, and German society fractured under the strain.'
      ],
      claims: [0, 7],
      agreements: [2],
      disagreements: [0, 7]
    },
    questions: [
      'What specific evidence does the military-economic interpretation use to support the idea of material exhaustion?',
      'How does the political interpretation reframe the role of American entry into the war?',
      'Both interpretations discuss events in 1917-1918. Which presents a more convincing timeline of collapse?',
      'What might the military historian say in response to the claim that political collapse was the primary cause of defeat?',
      'What evidence is missing from both interpretations? Consider the role of Allied strategy and the Eastern Front.',
      'Can material and political explanations be combined, or are they fundamentally different types of argument?'
    ]
  },
  {
    id: 'french-rev',
    label: 'The French Revolution',
    desc: 'Was the French Revolution driven by ideas or economics? (Marxist vs Liberal views)',
    historianA: {
      name: 'The Marxist Interpretation',
      desc: 'Class conflict and economic crisis drove revolution',
      sentences: [
        'The French Revolution was fundamentally a class struggle in which the rising bourgeoisie overthrew the feudal aristocracy to secure economic and political power.',
        'By the 1780s, the French economy was dominated by a capitalist bourgeoisie whose wealth and ambitions were blocked by an aristocratic system of privilege based on birth rather than merit.',
        'The evidence of cahiers de doleances (grievance books) from 1789 reveals widespread anger about feudal dues, tax inequality, and the privileges of the nobility and clergy.',
        'The financial crisis that forced Louis XVI to summon the Estates-General was not an accident but the result of structural contradictions in a feudal state trying to function in a capitalist economy.',
        'The Declaration of the Rights of Man, with its emphasis on property rights and legal equality, was a bourgeois document that served bourgeois interests.',
        'The abolition of feudal privileges on 4 August 1789 was the decisive act of the Revolution: it destroyed the legal basis of aristocratic power and opened the way for capitalist development.',
        'While Enlightenment ideas provided the language of revolution, they reflected and justified the material interests of the class that produced them.',
        'The Revolution must be understood as part of a broader transition from feudalism to capitalism that was reshaping European society.'
      ],
      claims: [0, 7],
      agreements: [2],
      disagreements: [0, 4, 7]
    },
    historianB: {
      name: 'The Liberal-Revisionist Interpretation',
      desc: 'Ideas, political culture, and contingency',
      sentences: [
        'The French Revolution was driven not by class conflict but by a crisis of political legitimacy, shaped by Enlightenment ideas about rights, reason, and popular sovereignty.',
        'The distinction between "bourgeoisie" and "aristocracy" is far less clear than Marxist historians suggest; many nobles were entrepreneurial, and many bourgeois aspired to noble status.',
        'The evidence shows that the cahiers de doleances expressed a wide range of grievances that cannot be reduced to class interest; demands for legal reform, religious tolerance, and political representation cut across social boundaries.',
        'The political culture of the Enlightenment, with its emphasis on rational debate, public opinion, and individual rights, created a new way of thinking about authority that made revolution thinkable.',
        'The Declaration of the Rights of Man was not a class document but a statement of universal principles that drew on decades of philosophical debate about natural rights.',
        'The Revolution took the course it did because of political decisions, factional struggles, and unforeseen events, not because of predetermined class dynamics.',
        'The radicalization of the Revolution after 1791, leading to the Terror, cannot be explained by class conflict; it was driven by war, political paranoia, and ideological extremism.',
        'To reduce the Revolution to economics is to strip it of its most important legacy: the idea that political authority must rest on the consent of the governed.'
      ],
      claims: [0, 7],
      agreements: [2],
      disagreements: [0, 1, 7]
    },
    questions: [
      'What evidence does the Marxist interpretation use to support the idea of class conflict?',
      'How does the liberal-revisionist view challenge the distinction between bourgeoisie and aristocracy?',
      'Both interpretations discuss the Declaration of the Rights of Man. How do they interpret this document differently?',
      'What might the Marxist historian say in response to the claim that ideas, not economics, drove the Revolution?',
      'What evidence is missing from both interpretations? Consider the role of peasants, women, and the sans-culottes.',
      'Can ideas and economic interests both be causes of revolution, or must one be primary?'
    ]
  }
];

let currentTopic = null;
let activeTag = null;
let highlightMode = null;
let meterValues = { A: 5, B: 5 };

function init() {
  const sel = document.getElementById('topicSelector');
  TOPICS.forEach((t, i) => {
    const btn = document.createElement('button');
    btn.className = 'topic-btn';
    btn.innerHTML = `<span class="topic-label">${t.label}</span><span class="topic-desc">${t.desc}</span>`;
    btn.onclick = () => selectTopic(i);
    sel.appendChild(btn);
  });
}

function selectTopic(index) {
  currentTopic = TOPICS[index];
  meterValues = { A: 5, B: 5 };
  activeTag = null;
  highlightMode = null;

  document.querySelectorAll('.topic-btn').forEach((b, i) => {
    b.classList.toggle('active', i === index);
  });
  document.querySelectorAll('.anno-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.hl-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('mainContent').style.display = 'block';
  document.getElementById('justifyArea').value = '';

  renderPanels();
  renderQuestions();
  updateMeters();
  updateVenn();
}

function renderPanels() {
  const grid = document.getElementById('comparisonGrid');
  grid.innerHTML = '';

  ['A', 'B'].forEach(side => {
    const data = side === 'A' ? currentTopic.historianA : currentTopic.historianB;
    const panel = document.createElement('div');
    panel.className = `interp-panel panel-${side.toLowerCase()}`;

    const header = document.createElement('div');
    header.className = 'panel-header';
    header.innerHTML = `<h3>${data.name}</h3><div class="historian-desc">${data.desc}</div>`;
    panel.appendChild(header);

    const body = document.createElement('div');
    body.className = 'panel-body';
    body.id = `panelBody${side}`;

    data.sentences.forEach((s, i) => {
      const span = document.createElement('span');
      span.className = 'sentence';
      span.dataset.side = side;
      span.dataset.index = i;
      span.textContent = s + ' ';
      span.onclick = () => handleSentenceClick(span, side, i);
      body.appendChild(span);
    });

    panel.appendChild(body);
    grid.appendChild(panel);
  });

  document.getElementById('meterLabelA').textContent = currentTopic.historianA.name;
  document.getElementById('meterLabelB').textContent = currentTopic.historianB.name;
}

function renderQuestions() {
  const qp = document.getElementById('questionsPanel');
  qp.innerHTML = '';
  currentTopic.questions.forEach(q => {
    const div = document.createElement('div');
    div.className = 'question-item';
    div.textContent = q;
    div.onclick = () => {
      const area = document.getElementById('justifyArea');
      area.focus();
      if (area.value.length > 0 && !area.value.endsWith('\n')) {
        area.value += '\n\n';
      }
      area.value += q + '\n';
    };
    qp.appendChild(div);
  });
}

/* Annotation toolbar */
document.querySelectorAll('.anno-btn').forEach(btn => {
  btn.onclick = () => {
    const tag = btn.dataset.tag;
    highlightMode = null;
    document.querySelectorAll('.hl-btn').forEach(b => b.classList.remove('active'));
    if (activeTag === tag) {
      activeTag = null;
      btn.classList.remove('active');
    } else {
      activeTag = tag;
      document.querySelectorAll('.anno-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }
  };
});

function toggleHighlightMode(mode) {
  activeTag = null;
  document.querySelectorAll('.anno-btn').forEach(b => b.classList.remove('active'));
  if (highlightMode === mode) {
    highlightMode = null;
    document.querySelectorAll('.hl-btn').forEach(b => b.classList.remove('active'));
  } else {
    highlightMode = mode;
    document.querySelectorAll('.hl-btn').forEach(b => {
      b.classList.toggle('active', b.classList.contains(mode));
    });
  }
}

function handleSentenceClick(el, side, index) {
  if (activeTag) {
    // Remove existing tag classes
    el.classList.remove('tagged-claim', 'tagged-evidence', 'tagged-judgement', 'tagged-opinion');
    // Remove existing badge
    const badge = el.querySelector('.tag-badge');
    if (badge) badge.remove();

    // Check if same tag (toggle off)
    if (el.dataset.currentTag === activeTag) {
      delete el.dataset.currentTag;
    } else {
      el.classList.add(`tagged-${activeTag}`);
      el.dataset.currentTag = activeTag;
      const b = document.createElement('span');
      b.className = 'tag-badge';
      b.style.color = getTagColor(activeTag);
      b.textContent = `[${activeTag.charAt(0).toUpperCase()}]`;
      el.appendChild(b);
    }
    updateVenn();
  } else if (highlightMode) {
    if (highlightMode === 'agree') {
      el.classList.toggle('agree-highlight');
      el.classList.remove('disagree-highlight');
    } else {
      el.classList.toggle('disagree-highlight');
      el.classList.remove('agree-highlight');
    }
  }
}

function getTagColor(tag) {
  const map = { claim: '#2980b9', evidence: '#27ae60', judgement: '#e67e22', opinion: '#9b59b6' };
  return map[tag] || '#333';
}

function clearAnnotations() {
  document.querySelectorAll('.sentence').forEach(el => {
    el.classList.remove('tagged-claim', 'tagged-evidence', 'tagged-judgement', 'tagged-opinion');
    delete el.dataset.currentTag;
    const badge = el.querySelector('.tag-badge');
    if (badge) badge.remove();
  });
  updateVenn();
}

function clearHighlights() {
  document.querySelectorAll('.sentence').forEach(el => {
    el.classList.remove('agree-highlight', 'disagree-highlight');
  });
}

/* Evidence meters */
function adjustMeter(side, delta) {
  meterValues[side] = Math.max(0, Math.min(10, meterValues[side] + delta));
  updateMeters();
}

function updateMeters() {
  ['A', 'B'].forEach(side => {
    const fill = document.getElementById(`meterFill${side}`);
    const val = meterValues[side];
    fill.style.width = `${val * 10}%`;
    fill.textContent = `${val}/10`;
  });
}

/* Venn diagram */
function updateVenn() {
  const canvas = document.getElementById('vennCanvas');
  const ctx = canvas.getContext('2d');
  const w = canvas.width;
  const h = canvas.height;
  ctx.clearRect(0, 0, w, h);

  if (!currentTopic) return;

  // Gather claims
  const claimsA = [];
  const claimsB = [];
  document.querySelectorAll('#panelBodyA .sentence').forEach(el => {
    if (el.dataset.currentTag === 'claim') claimsA.push(el.textContent.replace(/\[.\]$/, '').trim());
  });
  document.querySelectorAll('#panelBodyB .sentence').forEach(el => {
    if (el.dataset.currentTag === 'claim') claimsB.push(el.textContent.replace(/\[.\]$/, '').trim());
  });

  // Find shared (simplified: check agreement highlights)
  const agreeA = [];
  const agreeB = [];
  document.querySelectorAll('#panelBodyA .sentence.agree-highlight').forEach(el => {
    if (el.dataset.currentTag === 'claim') agreeA.push(el.textContent.replace(/\[.\]$/, '').trim());
  });
  document.querySelectorAll('#panelBodyB .sentence.agree-highlight').forEach(el => {
    if (el.dataset.currentTag === 'claim') agreeB.push(el.textContent.replace(/\[.\]$/, '').trim());
  });
  const sharedCount = agreeA.length + agreeB.length;
  const uniqueA = claimsA.length - agreeA.length;
  const uniqueB = claimsB.length - agreeB.length;

  // Draw circles
  const cx1 = w * 0.38, cx2 = w * 0.62, cy = h * 0.48, r = 95;

  ctx.globalAlpha = 0.25;
  ctx.fillStyle = '#1a7a6d';
  ctx.beginPath(); ctx.arc(cx1, cy, r, 0, Math.PI * 2); ctx.fill();
  ctx.fillStyle = '#8b2252';
  ctx.beginPath(); ctx.arc(cx2, cy, r, 0, Math.PI * 2); ctx.fill();
  ctx.globalAlpha = 1;

  ctx.strokeStyle = '#1a7a6d'; ctx.lineWidth = 2;
  ctx.beginPath(); ctx.arc(cx1, cy, r, 0, Math.PI * 2); ctx.stroke();
  ctx.strokeStyle = '#8b2252';
  ctx.beginPath(); ctx.arc(cx2, cy, r, 0, Math.PI * 2); ctx.stroke();

  // Labels
  ctx.font = 'bold 13px -apple-system, sans-serif';
  ctx.textAlign = 'center';
  ctx.fillStyle = '#145f54';
  ctx.fillText('Historian A', cx1 - 36, cy - r - 12);
  ctx.fillText(`${uniqueA} unique`, cx1 - 36, cy + 5);
  ctx.fillStyle = '#6e1a41';
  ctx.fillText('Historian B', cx2 + 36, cy - r - 12);
  ctx.fillText(`${uniqueB} unique`, cx2 + 36, cy + 5);

  // Shared
  ctx.fillStyle = '#333';
  ctx.font = 'bold 14px -apple-system, sans-serif';
  ctx.fillText(`${sharedCount} shared`, w / 2, cy + 5);

  // Totals
  ctx.font = '12px -apple-system, sans-serif';
  ctx.fillStyle = '#777';
  ctx.fillText(`Total claims tagged: A = ${claimsA.length}, B = ${claimsB.length}`, w / 2, h - 12);

  // Empty state
  if (claimsA.length === 0 && claimsB.length === 0) {
    ctx.font = 'italic 13px Georgia, serif';
    ctx.fillStyle = '#999';
    ctx.fillText('Tag sentences as "Claim" and mark agreements to populate this diagram.', w / 2, cy + 40);
  }
}

/* Info toggle */
function toggleInfo() {
  const content = document.getElementById('infoContent');
  const btn = document.getElementById('infoToggle');
  const isVisible = content.classList.toggle('visible');
  btn.classList.toggle('open', isVisible);
}

init();
</script>
</body>
</html>
