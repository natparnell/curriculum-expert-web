<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Progress 8 Calculator</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<style>
  :root {
    --bg: #f5f7fa;
    --surface: #ffffff;
    --primary: #1a5276;
    --primary-light: #2980b9;
    --primary-pale: #d6eaf8;
    --positive: #27ae60;
    --positive-light: #d5f5e3;
    --negative: #c0392b;
    --negative-light: #fadbd8;
    --neutral: #7f8c8d;
    --neutral-light: #eaecee;
    --text: #2c3e50;
    --text-light: #5d6d7e;
    --border: #d5d8dc;
    --shadow: 0 2px 8px rgba(0,0,0,0.08);
    --radius: 8px;
    --amber: #f39c12;
    --amber-light: #fef9e7;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
  }

  header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: var(--primary);
    color: white;
    padding: 16px 24px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  }

  header h1 { font-size: 1.4rem; font-weight: 700; }
  header p { font-size: 0.85rem; opacity: 0.85; margin-top: 2px; }

  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 20px 16px 60px;
  }

  .presets {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }

  .preset-btn {
    padding: 8px 18px;
    border: 2px solid var(--primary-light);
    background: var(--surface);
    color: var(--primary);
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 600;
    transition: all 0.2s;
  }

  .preset-btn:hover {
    background: var(--primary);
    color: white;
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }

  @media (max-width: 768px) {
    .grid { grid-template-columns: 1fr; }
    header h1 { font-size: 1.2rem; }
  }

  .card {
    background: var(--surface);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 20px;
    border: 1px solid var(--border);
  }

  .card-title {
    font-size: 1rem;
    font-weight: 700;
    color: var(--primary);
    margin-bottom: 14px;
    padding-bottom: 8px;
    border-bottom: 2px solid var(--primary-pale);
  }

  .full-width { grid-column: 1 / -1; }

  label {
    display: block;
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-light);
    margin-bottom: 4px;
    text-transform: uppercase;
    letter-spacing: 0.3px;
  }

  select, input[type="number"] {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 0.9rem;
    color: var(--text);
    background: var(--surface);
    transition: border-color 0.2s;
  }

  select:focus, input[type="number"]:focus {
    outline: none;
    border-color: var(--primary-light);
    box-shadow: 0 0 0 3px rgba(41,128,185,0.15);
  }

  .ks2-row {
    display: flex;
    gap: 12px;
    align-items: flex-end;
  }

  .ks2-row > div { flex: 1; }

  .bucket-section {
    margin-bottom: 16px;
  }

  .bucket-label {
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--primary);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .bucket-label .tag {
    font-size: 0.7rem;
    background: var(--primary-pale);
    color: var(--primary);
    padding: 2px 8px;
    border-radius: 10px;
    font-weight: 600;
  }

  .slot-row {
    display: flex;
    gap: 10px;
    margin-bottom: 8px;
    align-items: flex-end;
  }

  .slot-row .subject-col { flex: 2; }
  .slot-row .grade-col { flex: 1; }

  .p8-display {
    text-align: center;
    padding: 24px 16px;
  }

  .p8-number {
    font-size: 3.5rem;
    font-weight: 800;
    line-height: 1;
    margin-bottom: 6px;
  }

  .p8-label {
    font-size: 0.9rem;
    color: var(--text-light);
    font-weight: 600;
  }

  .p8-band {
    display: inline-block;
    margin-top: 10px;
    padding: 4px 16px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .score-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid var(--neutral-light);
  }

  .score-row:last-child { border-bottom: none; }
  .score-row .lbl { font-weight: 600; font-size: 0.85rem; }
  .score-row .val { font-weight: 700; font-size: 1rem; }

  .gauge-container {
    position: relative;
    height: 60px;
    margin: 16px 0 8px;
    background: linear-gradient(to right, #c0392b, #e74c3c, #f39c12, #f1c40f, #2ecc71, #27ae60);
    border-radius: 30px;
    overflow: visible;
  }

  .gauge-marker {
    position: absolute;
    top: -8px;
    width: 4px;
    height: 76px;
    background: var(--text);
    border-radius: 2px;
    transition: left 0.5s ease;
  }

  .gauge-marker::after {
    content: '';
    position: absolute;
    top: -6px;
    left: -6px;
    width: 16px;
    height: 16px;
    background: var(--text);
    border-radius: 50%;
    border: 3px solid white;
  }

  .gauge-labels {
    display: flex;
    justify-content: space-between;
    font-size: 0.65rem;
    color: var(--text-light);
    margin-top: 4px;
    font-weight: 600;
  }

  .element-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-top: 12px;
  }

  .element-card {
    background: var(--bg);
    border-radius: 6px;
    padding: 12px;
    text-align: center;
  }

  .element-card .el-name {
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--text-light);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .element-card .el-score {
    font-size: 1.5rem;
    font-weight: 800;
    margin-top: 4px;
  }

  .chart-container {
    position: relative;
    width: 100%;
    max-height: 320px;
  }

  .info-panel {
    font-size: 0.85rem;
    line-height: 1.7;
  }

  .info-panel h3 {
    font-size: 0.95rem;
    color: var(--primary);
    margin: 14px 0 6px;
  }

  .info-panel h3:first-child { margin-top: 0; }

  .info-panel ul {
    margin-left: 20px;
    margin-bottom: 8px;
  }

  .info-panel li { margin-bottom: 4px; }

  .info-toggle {
    background: var(--primary-pale);
    color: var(--primary);
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 700;
    font-size: 0.85rem;
    width: 100%;
    text-align: left;
    transition: background 0.2s;
  }

  .info-toggle:hover { background: #bbd6ec; }

  .info-content {
    display: none;
    margin-top: 12px;
  }

  .info-content.open { display: block; }
</style>
</head>
<body>

<header>
  <h1>Progress 8 Calculator</h1>
  <p>Input GCSE grades to calculate and visualise a student's Progress 8 score</p>
</header>

<div class="container">

  <div style="margin-bottom: 16px;">
    <label style="margin-bottom: 8px; display: block;">Quick Presets</label>
    <div class="presets">
      <button class="preset-btn" onclick="loadPreset('strong')">Strong Student</button>
      <button class="preset-btn" onclick="loadPreset('average')">Average Student</button>
      <button class="preset-btn" onclick="loadPreset('below')">Below Average Student</button>
      <button class="preset-btn" onclick="loadPreset('clear')">Clear All</button>
    </div>
  </div>

  <div class="grid">

    <!-- KS2 Prior Attainment -->
    <div class="card">
      <div class="card-title">KS2 Prior Attainment</div>
      <div class="ks2-row">
        <div>
          <label>Band</label>
          <select id="ks2Band" onchange="syncKS2()">
            <option value="high">High (110-120)</option>
            <option value="middle" selected>Middle (100-109)</option>
            <option value="low">Low (80-99)</option>
          </select>
        </div>
        <div>
          <label>Scaled Score</label>
          <input type="number" id="ks2Score" min="80" max="120" value="104" onchange="recalculate()">
        </div>
      </div>
      <p style="font-size:0.75rem; color:var(--text-light); margin-top:8px;">
        The KS2 scaled score determines the expected GCSE attainment for this student.
      </p>
    </div>

    <!-- P8 Score Display -->
    <div class="card">
      <div class="p8-display">
        <div class="p8-label">Overall Progress 8</div>
        <div class="p8-number" id="p8Score">0.00</div>
        <div class="p8-band" id="p8Band">Average</div>
      </div>
    </div>

    <!-- English Bucket -->
    <div class="card">
      <div class="card-title">Student Grade Inputs</div>

      <div class="bucket-section">
        <div class="bucket-label">English <span class="tag">Double Weighted</span></div>
        <div class="slot-row">
          <div class="subject-col">
            <label>Subject</label>
            <select disabled><option>English Language / Literature</option></select>
          </div>
          <div class="grade-col">
            <label>Grade</label>
            <select id="eng-grade" onchange="recalculate()">
              <option value="">--</option>
              <option value="9">9</option><option value="8">8</option><option value="7">7</option>
              <option value="6">6</option><option value="5">5</option><option value="4">4</option>
              <option value="3">3</option><option value="2">2</option><option value="1">1</option>
            </select>
          </div>
        </div>
      </div>

      <div class="bucket-section">
        <div class="bucket-label">Maths <span class="tag">Double Weighted</span></div>
        <div class="slot-row">
          <div class="subject-col">
            <label>Subject</label>
            <select disabled><option>Mathematics</option></select>
          </div>
          <div class="grade-col">
            <label>Grade</label>
            <select id="maths-grade" onchange="recalculate()">
              <option value="">--</option>
              <option value="9">9</option><option value="8">8</option><option value="7">7</option>
              <option value="6">6</option><option value="5">5</option><option value="4">4</option>
              <option value="3">3</option><option value="2">2</option><option value="1">1</option>
            </select>
          </div>
        </div>
      </div>

      <div class="bucket-section">
        <div class="bucket-label">EBacc Slots <span class="tag">3 Subjects</span></div>
        <div id="ebacc-slots"></div>
      </div>

      <div class="bucket-section">
        <div class="bucket-label">Open Slots <span class="tag">3 Subjects</span></div>
        <div id="open-slots"></div>
      </div>
    </div>

    <!-- Scores Breakdown -->
    <div class="card">
      <div class="card-title">Score Breakdown</div>
      <div class="score-row">
        <span class="lbl">Attainment 8 (Actual)</span>
        <span class="val" id="att8Actual">0</span>
      </div>
      <div class="score-row">
        <span class="lbl">Attainment 8 (Expected)</span>
        <span class="val" id="att8Expected">0</span>
      </div>
      <div class="score-row">
        <span class="lbl">Progress 8 Score</span>
        <span class="val" id="p8Value">0.00</span>
      </div>

      <div class="element-grid">
        <div class="element-card">
          <div class="el-name">English</div>
          <div class="el-score" id="elEng">0.00</div>
        </div>
        <div class="element-card">
          <div class="el-name">Maths</div>
          <div class="el-score" id="elMaths">0.00</div>
        </div>
        <div class="element-card">
          <div class="el-name">EBacc</div>
          <div class="el-score" id="elEbacc">0.00</div>
        </div>
        <div class="element-card">
          <div class="el-name">Open</div>
          <div class="el-score" id="elOpen">0.00</div>
        </div>
      </div>

      <div style="margin-top: 16px;">
        <div class="card-title" style="font-size:0.85rem;">National Comparison</div>
        <div class="gauge-container">
          <div class="gauge-marker" id="gaugeMarker" style="left:50%;"></div>
        </div>
        <div class="gauge-labels">
          <span>Well Below<br>(&lt; -0.5)</span>
          <span>Below<br>(-0.5 to -0.15)</span>
          <span>Average<br>(-0.15 to +0.15)</span>
          <span>Above<br>(+0.15 to +0.5)</span>
          <span>Well Above<br>(&gt; +0.5)</span>
        </div>
      </div>
    </div>

    <!-- Chart -->
    <div class="card full-width">
      <div class="card-title">Element Comparison: Actual vs Expected</div>
      <div class="chart-container">
        <canvas id="elementChart"></canvas>
      </div>
    </div>

    <!-- Info Panel -->
    <div class="card full-width">
      <button class="info-toggle" onclick="toggleInfo()">
        What is Progress 8? (Click to expand)
      </button>
      <div class="info-content" id="infoContent">
        <div class="info-panel">
          <h3>What is Progress 8?</h3>
          <p>Progress 8 is the headline measure used by the Department for Education to assess the effectiveness of secondary schools in England. It measures the progress students make from the end of primary school (Key Stage 2) to their GCSE results (Key Stage 4), compared to students nationally who had similar KS2 starting points.</p>

          <h3>How is it calculated?</h3>
          <p>Progress 8 works by comparing a student's actual GCSE results (Attainment 8) against the results that would be expected given their KS2 prior attainment. The calculation is:</p>
          <ul>
            <li><strong>Attainment 8</strong>: the total points from a student's best 8 qualifying GCSE grades, with English and Maths double weighted (making 10 slots in total).</li>
            <li><strong>Expected Attainment 8</strong>: the national average Attainment 8 score for students with the same KS2 scaled score.</li>
            <li><strong>Progress 8 = (Actual Attainment 8 - Expected Attainment 8) / 10</strong></li>
          </ul>

          <h3>The Four Buckets</h3>
          <ul>
            <li><strong>English (double weighted)</strong>: the best grade from English Language or English Literature. Counts twice, filling 2 of the 10 slots.</li>
            <li><strong>Maths (double weighted)</strong>: the Maths GCSE grade. Counts twice, filling 2 of the 10 slots.</li>
            <li><strong>EBacc (3 slots)</strong>: the best 3 grades from EBacc qualifying subjects: sciences, computer science, geography, history, and languages.</li>
            <li><strong>Open (3 slots)</strong>: the best 3 remaining GCSE or approved vocational qualifications.</li>
          </ul>

          <h3>Why Double Weighting?</h3>
          <p>English and Maths are double weighted because they are considered the most important qualifications for future education and employment. The DfE wants to incentivise schools to prioritise these core subjects. Each counts for 2 of the 10 scoring slots.</p>

          <h3>What is a "good" Progress 8 score?</h3>
          <ul>
            <li><strong>0.0</strong>: students made progress exactly in line with the national average for their starting point.</li>
            <li><strong>Positive scores</strong>: students made more progress than average. A score of +0.5 means roughly half a grade above expected across all 8 qualifications.</li>
            <li><strong>Negative scores</strong>: students made less progress than average. A score of -0.5 means roughly half a grade below expected.</li>
            <li>A school is considered "well above average" if its P8 is significantly above zero (confidence interval does not cross zero).</li>
          </ul>

          <h3>How Schools Use Progress 8</h3>
          <p>Schools use Progress 8 to evaluate their overall effectiveness, identify subjects or departments where students underperform relative to expectations, and track year-on-year improvement. Ofsted uses P8 as part of its data dashboard when inspecting schools. School leaders analyse P8 by student groups (disadvantaged, SEN, gender, ethnicity) to identify gaps and target interventions.</p>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
  const ebaccSubjects = [
    'Biology', 'Chemistry', 'Physics', 'Combined Science',
    'Computer Science', 'Geography', 'History',
    'French', 'German', 'Spanish', 'Latin', 'Other MFL'
  ];

  const openSubjects = [
    'Art & Design', 'Business', 'Citizenship', 'Design & Technology',
    'Drama', 'Economics', 'Engineering', 'Film Studies', 'Food Prep & Nutrition',
    'Media Studies', 'Music', 'PE', 'Psychology', 'Religious Studies',
    'Sociology', 'Statistics', 'Other Approved'
  ];

  const gradeOptions = '<option value="">--</option>' +
    [9,8,7,6,5,4,3,2,1].map(g => `<option value="${g}">${g}</option>`).join('');

  function buildSlots(containerId, subjects, prefix, count) {
    const el = document.getElementById(containerId);
    let html = '';
    for (let i = 0; i < count; i++) {
      html += `<div class="slot-row">
        <div class="subject-col">
          <label>Subject ${i + 1}</label>
          <select id="${prefix}-subj-${i}">
            <option value="">-- Select --</option>
            ${subjects.map(s => `<option value="${s}">${s}</option>`).join('')}
          </select>
        </div>
        <div class="grade-col">
          <label>Grade</label>
          <select id="${prefix}-grade-${i}" onchange="recalculate()">
            ${gradeOptions}
          </select>
        </div>
      </div>`;
    }
    el.innerHTML = html;
  }

  buildSlots('ebacc-slots', ebaccSubjects, 'ebacc', 3);
  buildSlots('open-slots', openSubjects, 'open', 3);

  // Simplified national expected attainment 8 lookup based on KS2 scaled score.
  // These are approximate values derived from published DfE estimates.
  const expectedA8Lookup = {
    80: 15.0, 81: 16.0, 82: 17.0, 83: 18.0, 84: 19.5,
    85: 21.0, 86: 22.5, 87: 24.0, 88: 25.5, 89: 27.0,
    90: 28.5, 91: 30.0, 92: 31.5, 93: 33.0, 94: 34.5,
    95: 36.0, 96: 37.5, 97: 39.0, 98: 40.5, 99: 42.0,
    100: 43.5, 101: 45.0, 102: 46.5, 103: 48.0, 104: 49.5,
    105: 51.0, 106: 52.5, 107: 54.0, 108: 55.5, 109: 57.0,
    110: 58.5, 111: 60.0, 112: 61.5, 113: 63.0, 114: 64.5,
    115: 66.0, 116: 67.5, 117: 69.0, 118: 71.0, 119: 73.0,
    120: 75.0
  };

  // Expected element breakdown (approximate proportions of total expected A8)
  // English element: 2/10, Maths: 2/10, EBacc: 3/10, Open: 3/10
  function getExpectedElements(expectedA8) {
    return {
      eng: (expectedA8 * 2) / 10,
      maths: (expectedA8 * 2) / 10,
      ebacc: (expectedA8 * 3) / 10,
      open: (expectedA8 * 3) / 10
    };
  }

  function getGradeVal(id) {
    const v = document.getElementById(id).value;
    return v === '' ? null : parseInt(v);
  }

  function syncKS2() {
    const band = document.getElementById('ks2Band').value;
    const scoreEl = document.getElementById('ks2Score');
    if (band === 'high') scoreEl.value = 115;
    else if (band === 'middle') scoreEl.value = 104;
    else scoreEl.value = 92;
    recalculate();
  }

  let chart = null;

  function recalculate() {
    const ks2 = Math.max(80, Math.min(120, parseInt(document.getElementById('ks2Score').value) || 100));

    const engGrade = getGradeVal('eng-grade');
    const mathsGrade = getGradeVal('maths-grade');

    const ebaccGrades = [];
    for (let i = 0; i < 3; i++) {
      const g = getGradeVal(`ebacc-grade-${i}`);
      if (g !== null) ebaccGrades.push(g);
    }

    const openGrades = [];
    for (let i = 0; i < 3; i++) {
      const g = getGradeVal(`open-grade-${i}`);
      if (g !== null) openGrades.push(g);
    }

    // Actual element totals (points, not divided)
    const engPoints = engGrade !== null ? engGrade * 2 : 0;
    const mathsPoints = mathsGrade !== null ? mathsGrade * 2 : 0;
    const ebaccPoints = ebaccGrades.reduce((s, g) => s + g, 0);
    const openPoints = openGrades.reduce((s, g) => s + g, 0);

    const actualA8 = engPoints + mathsPoints + ebaccPoints + openPoints;

    // Expected
    const expectedA8 = expectedA8Lookup[ks2] || 49.5;
    const expectedEl = getExpectedElements(expectedA8);

    // Progress 8 overall
    const p8 = (actualA8 - expectedA8) / 10;

    // Element P8 scores
    // English element: (actual eng points - expected eng points) / 2
    // Maths element: (actual maths points - expected maths points) / 2
    // EBacc element: (actual ebacc points - expected ebacc points) / 3
    // Open element: (actual open points - expected open points) / 3
    const elEng = (engPoints - expectedEl.eng) / 2;
    const elMaths = (mathsPoints - expectedEl.maths) / 2;
    const elEbacc = (ebaccPoints - expectedEl.ebacc) / 3;
    const elOpen = (openPoints - expectedEl.open) / 3;

    // Update display
    const p8El = document.getElementById('p8Score');
    p8El.textContent = p8.toFixed(2);
    p8El.style.color = p8 >= 0 ? 'var(--positive)' : 'var(--negative)';

    document.getElementById('p8Value').textContent = p8.toFixed(2);
    document.getElementById('p8Value').style.color = p8 >= 0 ? 'var(--positive)' : 'var(--negative)';

    document.getElementById('att8Actual').textContent = actualA8;
    document.getElementById('att8Expected').textContent = expectedA8.toFixed(1);

    function setElScore(id, val) {
      const el = document.getElementById(id);
      el.textContent = val.toFixed(2);
      el.style.color = val >= 0 ? 'var(--positive)' : 'var(--negative)';
    }

    setElScore('elEng', elEng);
    setElScore('elMaths', elMaths);
    setElScore('elEbacc', elEbacc);
    setElScore('elOpen', elOpen);

    // P8 band
    const bandEl = document.getElementById('p8Band');
    let bandText, bandBg, bandColor;
    if (p8 > 0.5) { bandText = 'Well Above Average'; bandBg = 'var(--positive)'; bandColor = 'white'; }
    else if (p8 > 0.15) { bandText = 'Above Average'; bandBg = 'var(--positive-light)'; bandColor = 'var(--positive)'; }
    else if (p8 >= -0.15) { bandText = 'Average'; bandBg = 'var(--amber-light)'; bandColor = 'var(--amber)'; }
    else if (p8 >= -0.5) { bandText = 'Below Average'; bandBg = 'var(--negative-light)'; bandColor = 'var(--negative)'; }
    else { bandText = 'Well Below Average'; bandBg = 'var(--negative)'; bandColor = 'white'; }

    bandEl.textContent = bandText;
    bandEl.style.background = bandBg;
    bandEl.style.color = bandColor;

    // Gauge marker: map P8 from -1.5..+1.5 to 0%..100%
    const pct = Math.max(0, Math.min(100, ((p8 + 1.5) / 3) * 100));
    document.getElementById('gaugeMarker').style.left = pct + '%';

    // Chart
    updateChart(
      [engPoints, mathsPoints, ebaccPoints, openPoints],
      [expectedEl.eng, expectedEl.maths, expectedEl.ebacc, expectedEl.open]
    );
  }

  function updateChart(actual, expected) {
    const ctx = document.getElementById('elementChart').getContext('2d');

    if (chart) chart.destroy();

    chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['English (x2)', 'Maths (x2)', 'EBacc (3 slots)', 'Open (3 slots)'],
        datasets: [
          {
            label: 'Actual Points',
            data: actual,
            backgroundColor: 'rgba(41, 128, 185, 0.7)',
            borderColor: 'rgba(41, 128, 185, 1)',
            borderWidth: 1,
            borderRadius: 4
          },
          {
            label: 'Expected Points',
            data: expected.map(v => parseFloat(v.toFixed(1))),
            backgroundColor: 'rgba(189, 195, 199, 0.5)',
            borderColor: 'rgba(189, 195, 199, 1)',
            borderWidth: 1,
            borderRadius: 4
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: {
            position: 'top',
            labels: { font: { size: 12, weight: '600' }, usePointStyle: true, padding: 16 }
          },
          tooltip: {
            callbacks: {
              afterBody: function(context) {
                const idx = context[0].dataIndex;
                const diff = actual[idx] - expected[idx];
                return `Difference: ${diff >= 0 ? '+' : ''}${diff.toFixed(1)}`;
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            max: 18,
            title: { display: true, text: 'Points', font: { weight: '600' } },
            grid: { color: 'rgba(0,0,0,0.05)' }
          },
          x: {
            grid: { display: false }
          }
        }
      }
    });
  }

  function toggleInfo() {
    const el = document.getElementById('infoContent');
    el.classList.toggle('open');
    const btn = el.previousElementSibling;
    btn.textContent = el.classList.contains('open')
      ? 'What is Progress 8? (Click to collapse)'
      : 'What is Progress 8? (Click to expand)';
  }

  // Presets
  const presets = {
    strong: {
      ks2Band: 'high', ks2Score: 115,
      eng: '8', maths: '9',
      ebacc: [
        { subj: 'Biology', grade: '8' },
        { subj: 'History', grade: '7' },
        { subj: 'French', grade: '8' }
      ],
      open: [
        { subj: 'Art & Design', grade: '7' },
        { subj: 'Psychology', grade: '8' },
        { subj: 'Religious Studies', grade: '7' }
      ]
    },
    average: {
      ks2Band: 'middle', ks2Score: 104,
      eng: '5', maths: '5',
      ebacc: [
        { subj: 'Combined Science', grade: '5' },
        { subj: 'Geography', grade: '5' },
        { subj: 'Spanish', grade: '4' }
      ],
      open: [
        { subj: 'Business', grade: '5' },
        { subj: 'Drama', grade: '5' },
        { subj: 'PE', grade: '5' }
      ]
    },
    below: {
      ks2Band: 'low', ks2Score: 92,
      eng: '3', maths: '2',
      ebacc: [
        { subj: 'Combined Science', grade: '3' },
        { subj: 'Geography', grade: '2' },
        { subj: 'French', grade: '2' }
      ],
      open: [
        { subj: 'Design & Technology', grade: '3' },
        { subj: 'Music', grade: '3' },
        { subj: 'PE', grade: '3' }
      ]
    }
  };

  function loadPreset(name) {
    if (name === 'clear') {
      document.getElementById('ks2Band').value = 'middle';
      document.getElementById('ks2Score').value = 104;
      document.getElementById('eng-grade').value = '';
      document.getElementById('maths-grade').value = '';
      for (let i = 0; i < 3; i++) {
        document.getElementById(`ebacc-subj-${i}`).value = '';
        document.getElementById(`ebacc-grade-${i}`).value = '';
        document.getElementById(`open-subj-${i}`).value = '';
        document.getElementById(`open-grade-${i}`).value = '';
      }
      recalculate();
      return;
    }

    const p = presets[name];
    document.getElementById('ks2Band').value = p.ks2Band;
    document.getElementById('ks2Score').value = p.ks2Score;
    document.getElementById('eng-grade').value = p.eng;
    document.getElementById('maths-grade').value = p.maths;

    for (let i = 0; i < 3; i++) {
      document.getElementById(`ebacc-subj-${i}`).value = p.ebacc[i].subj;
      document.getElementById(`ebacc-grade-${i}`).value = p.ebacc[i].grade;
      document.getElementById(`open-subj-${i}`).value = p.open[i].subj;
      document.getElementById(`open-grade-${i}`).value = p.open[i].grade;
    }

    recalculate();
  }

  // Initial calculation
  recalculate();
</script>

</body>
</html>